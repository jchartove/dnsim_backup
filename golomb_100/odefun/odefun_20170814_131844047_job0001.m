function [Y,T] = odefun_20170814_131844047_job0001
tspan=[0 2000]; dt=0.01;
T=tspan(1):dt:tspan(2); nstep=length(T);
nreports = 5; tmp = 1:(nstep-1)/nreports:nstep; enableLog = tmp(2:end);
fprintf('\nThe odefun file used is: odefun_20170814_131844047_job0001 \n');
fprintf('\nSimulation interval: %g-%g\n',tspan(1),tspan(2));
fprintf('Starting integration (rk4, dt=%g)\n',dt);
soma_soma_soma_soma_iSYN_gsyn2 = (0.08) - (1).*((0.08) - 0.005);
soma_soma_soma_soma_iSYN_width = inf;
soma_soma_soma_soma_iSYN_Nmax = max((100),(100));
soma_soma_soma_soma_iSYN_srcpos = linspace(1,soma_soma_soma_soma_iSYN_Nmax,(100))'*ones(1,(100));
soma_soma_soma_soma_iSYN_dstpos = (linspace(1,soma_soma_soma_soma_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_soma_soma_soma_iSYN_mask = genmask((100),(100),(0.3),soma_soma_soma_soma_iSYN_gsyn2,1,1,0);
dend_soma_dend_soma_iCOM_compcon = eye((100),(100));
dend_dend_golomb_K_gd_dend = (8)/10;
dend_dend_golomb_Kdr_gkdr_dend = (225)/10;
dend_dend_golomb_Na_gna_dend = (112)/10;
dend_dend_input_tonic2 = (0) + 10.*(1);
dend_dend_iMultiPoissonExp_Ge = corr_Poisson((100), (50), (2), (1), (1), 2, .5, (2000), (0.01), (0));
dend_dend_iMultiPoissonExp_Gi = corr_Poisson((100), (0), (2), (1), (1), 5, .5, (2000), (0.01), (0));
soma_dend_soma_dend_iCOM_compcon = eye((100),(100));
dend_dend_dend_dend_iGAP_g_GAP2 = (0.04) + (1).*(0.4-(0.04));
dend_dend_dend_dend_iGAP_Nmax = max((100),(100));
dend_dend_dend_dend_iGAP_Xpre = linspace(1,dend_dend_dend_dend_iGAP_Nmax,(100))'*ones(1,(100));
dend_dend_dend_dend_iGAP_Xpost = (linspace(1,dend_dend_dend_dend_iGAP_Nmax,(100))'*ones(1,(100)))';
dend_dend_dend_dend_iGAP_mask = genmask((100),(100),(0.3),dend_dend_dend_dend_iGAP_g_GAP2,0,1,0);
D1_naCurrentMSN_V_IC = -63+63*randn((100),1);
D1_kCurrentMSN_V_IC = -63+63*randn((100),1);
D1_mCurrentMSN_Qs = (2.3)^(.1*(37-23));
D1_mCurrentMSN_V_IC = -63+63*randn((100),1);
D1_injectedCurrentD1_freq = 1/(2*pi);
soma_D1_soma_MSN_iSYN_indegree = (0.1)*((100)-(0));
soma_D1_soma_MSN_iSYN_gsyn2 = (10*(0.01))/(soma_D1_soma_MSN_iSYN_indegree+1);
soma_D1_soma_MSN_iSYN_width = inf;
soma_D1_soma_MSN_iSYN_Nmax = max((100),(100));
soma_D1_soma_MSN_iSYN_srcpos = linspace(1,soma_D1_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100));
soma_D1_soma_MSN_iSYN_dstpos = (linspace(1,soma_D1_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_D1_soma_MSN_iSYN_mask = genmask((100),(100),(0.1),soma_D1_soma_MSN_iSYN_gsyn2,1,0,(0));
D1_D1_gabaRecInputMSN_netcon = ones((100))-eye((100));
D2_naCurrentMSN_V_IC = -63+63*randn((100),1);
D2_kCurrentMSN_V_IC = -63+63*randn((100),1);
D2_mCurrentMSN_Qs = (2.3)^(.1*(37-23));
D2_mCurrentMSN_V_IC = -63+63*randn((100),1);
D2_injectedCurrentD2_freq = 1/(2*pi);
soma_D2_soma_MSN_iSYN_indegree = (0.1)*((100)-(0));
soma_D2_soma_MSN_iSYN_gsyn2 = (10*(0.01))/(soma_D2_soma_MSN_iSYN_indegree+1);
soma_D2_soma_MSN_iSYN_width = inf;
soma_D2_soma_MSN_iSYN_Nmax = max((100),(100));
soma_D2_soma_MSN_iSYN_srcpos = linspace(1,soma_D2_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100));
soma_D2_soma_MSN_iSYN_dstpos = (linspace(1,soma_D2_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_D2_soma_MSN_iSYN_mask = genmask((100),(100),(0.1),soma_D2_soma_MSN_iSYN_gsyn2,1,0,(0));
D2_D2_gabaRecInputMSN_netcon = ones((100))-eye((100));
soma_v = zeros(100,nstep);
soma_v(:,1) = [-53.4738     -48.0193     -38.2845     -21.4796      -29.539     -11.6812     -16.7314     -39.0005     -36.8042     -9.82596     -31.9217     -11.3027     -31.5288     -21.2161     -53.1986     -22.4418     -8.49204      -12.873    -0.359103     -41.8775     -69.6526     -3.55011      -75.964     -75.4632     -5.10688     -72.6685     -69.4262     -10.6913     -83.7838      -55.741     -77.6089     -87.6299     -67.8891     -7.99472     -76.9857     -81.8508     -31.2836     -24.2287     -83.9495     -34.6441     -6.58859     -28.9207     -30.4485     -13.2246     -69.9752     -29.3998     -39.5234     -79.1468     -16.6639     -49.7256      -17.006     -81.5479     -40.8749     -9.82797     -2.46199     -63.9216     -7.86683     -10.4584     -39.5103     -15.7059     -84.7518     -38.3451    -0.478408     -35.2602     -14.7337     -82.8083     -19.7334     -35.5816     -22.2767     -77.5994     -44.9546     -16.6711     -44.2021     -67.7887     -66.4297     -4.15536     -13.7557      -32.947     -42.4599     -6.25024     -5.18381     -25.1121     -24.6946     -51.2215     -47.2812     -7.77097     -41.6183     -1.90336     -7.18007     -37.7421     -34.5932     -26.9393     -16.9569     -53.2173     -28.1344     -4.64284     -30.9018     -10.6979     -5.29999     -13.1649];
soma_soma_golomb_K_a = zeros(100,nstep);
soma_soma_golomb_K_a(:,1) = [0.44946     0.17972     0.43335     0.67294     0.49321     0.25991     0.38088      0.4037     0.27537     0.44582     0.53927     0.42716     0.56918     0.46174      0.5089     0.62127      0.5445     0.44164     0.49493     0.30009     0.43431     0.55037     0.68787     0.52097      0.6875     0.15634     0.21681     0.15474     0.55719     0.46952      0.5705     0.29002     0.71545     0.68528     0.15663     0.41513     0.64365     0.21167      0.7125     0.45951     0.26969      0.5757     0.66941     0.19914     0.63644     0.37758     0.64588     0.50201     0.44172     0.49066     0.69981      0.3307      0.2278     0.31797     0.44701     0.37875     0.16099     0.56194     0.22566     0.35164     0.22602     0.21676     0.24821     0.34799      0.3101     0.38639     0.27134     0.51796     0.65136     0.69205     0.60817     0.50383     0.29104     0.19018     0.57846     0.17945     0.38319     0.54255     0.27971     0.41262      0.2668     0.57837     0.16479     0.41524     0.48721     0.36238     0.66905     0.44989     0.21854     0.24519     0.69612     0.52727     0.16502     0.64213     0.66496     0.40281     0.53461     0.65729     0.44382     0.30556];
soma_soma_golomb_K_b = zeros(100,nstep);
soma_soma_golomb_K_b(:,1) = [0.22124     0.38226     0.57394     0.15017     0.17024     0.52565     0.18578       0.403     0.53785     0.39041       0.439     0.59658     0.49866     0.44419      0.5421     0.41639     0.38491     0.40206     0.20582     0.16508     0.28879     0.20206     0.24012     0.42466     0.34428     0.17429     0.57631     0.23974     0.15032     0.38829     0.35815     0.46502     0.32645     0.39484     0.35044     0.17873     0.57384     0.35015     0.40987     0.30235     0.41476     0.42001     0.45656     0.25313     0.47154     0.45053     0.41615     0.42256     0.48125     0.35519     0.39036      0.2073     0.28106     0.37054     0.21216     0.15206     0.18227     0.17212     0.39166     0.30744     0.19725     0.32977      0.2882     0.43074      0.2736     0.59559      0.5799     0.56925     0.22758     0.48593     0.42961     0.26893     0.54463     0.49456     0.59713     0.55536     0.18126     0.34214     0.48083      0.3012     0.22751     0.50996     0.40404     0.51501     0.41229     0.55874     0.54713      0.2071     0.47385     0.33145     0.32118     0.47206     0.45836     0.29963     0.43353     0.59915     0.17492     0.47748     0.18891     0.54764];
soma_soma_golomb_Kdr_n = zeros(100,nstep);
soma_soma_golomb_Kdr_n(:,1) = [0.085454     0.28821     0.43141     0.48279     0.38394     0.45314     0.36161     0.12363     0.32884     0.46624     0.14438     0.47375     0.14568      0.4374     0.10757     0.46481     0.17042     0.19858     0.26252     0.46033     0.10282     0.11533     0.45334     0.21776     0.21512      0.3289     0.27771     0.23409     0.32803     0.30949     0.36471     0.42448     0.12724     0.37149     0.17552     0.11309     0.47647     0.25806     0.28196     0.36376      0.3959     0.19593     0.36666     0.16013    0.053061     0.29281     0.28872     0.43636     0.31043     0.42873     0.38263     0.08567    0.061868     0.17633     0.33459     0.13837     0.43341     0.40036     0.29873     0.09905     0.29934     0.10022     0.20195     0.47419     0.21045     0.35958     0.20391     0.46928     0.23833     0.34221     0.25455    0.061881     0.16784      0.4289     0.45976     0.48894    0.068259      0.2865     0.20986       0.447     0.46256     0.30685     0.32708     0.26706     0.43297     0.14232    0.062641     0.43978     0.38166    0.055543     0.47851     0.31775     0.43076     0.45504      0.2219     0.45367     0.19551     0.34875      0.2951     0.47716];
soma_soma_golomb_Na_h = zeros(100,nstep);
soma_soma_golomb_Na_h(:,1) = [0.06842     0.33982     0.48713     0.89357     0.25179     0.29716     0.84411     0.43741     0.77861     0.68178     0.16151     0.47643      0.7013     0.83548     0.68681     0.70014     0.60697     0.70428     0.65741     0.77879     0.11367     0.69133       0.792     0.15524     0.36794     0.41077     0.38998     0.64823      0.6402    0.075209     0.40578     0.62097     0.74631     0.80761     0.46477      0.5925     0.37024     0.41571     0.76381     0.28409     0.10022     0.72818     0.85561     0.51591     0.85271     0.62979     0.43102     0.29662     0.30228    0.087734     0.72584      0.2307     0.41146     0.56308      0.5477     0.18949     0.19912     0.54636     0.86432     0.29145     0.19301      0.3902     0.67465     0.66714     0.35824      0.5813     0.27981     0.69133     0.81323    0.062591      0.2431     0.89065     0.76293     0.14632     0.41774       0.169     0.37562     0.85893     0.82603      0.8712     0.79452      0.1327     0.45551     0.27229     0.58045     0.14186     0.68533     0.36626     0.48108      0.1297     0.73879      0.8823     0.82265     0.14905      0.6244     0.75605     0.58023     0.30647    0.059423     0.43641];
soma_soma_soma_soma_iSYN_s = zeros(100,nstep);
soma_soma_soma_soma_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
dend_v = zeros(100,nstep);
dend_v(:,1) = [-89.6718     -68.6063     -71.0393     -51.5458     -79.2392     -9.94709     -44.5788     -35.4249     -46.5677     -26.7543     -44.7963     -42.9272      -31.871     -68.3301     -68.2946     -55.5797     -59.6303     -86.3162     -53.7894     -18.5453     -88.1825     -11.8338     -4.72777     -73.5167     -41.9473     -45.1928     -47.5603      -64.052     -36.0208     -74.3881     -36.9112     -55.5423     -56.1993     -25.2699     -63.3939     -41.3959     -45.8389     -38.7663     -73.4312     -84.1595     -32.9491     -9.95316     -45.4823     -11.5245      -47.785     -43.8083     -72.5969     -9.16471     -1.28442     -60.2147     -22.1364     -45.4821     -32.9683     -65.0819     -30.5668     -88.9279     -6.25683     -37.0692     -2.32731     -2.05392     -73.5047     -18.1104     -87.3037     -78.9678     -54.2134     -45.9224     -52.5833     -82.7791      -54.154     -89.7713     -62.5391     -30.7363     -87.1392     -83.3444     -54.1343     -60.9517     -55.5221     -89.5575      -17.802     -25.6279     -81.1094     -8.00632      -9.7238     -24.2791     -66.4907     -41.7745     -12.2168     -29.5117     -56.6961     -47.2206     -70.7763     -68.8882     -86.0544     -9.61732      -44.134     -40.4155     -86.6623     -89.8773     -42.8743     -10.7313];
dend_dend_golomb_K_a = zeros(100,nstep);
dend_dend_golomb_K_a(:,1) = [0.41906     0.33285     0.74179     0.67219     0.74101     0.25115     0.30875     0.58347     0.42222     0.56441      0.5173      0.4599     0.50309     0.68201     0.48081     0.23105     0.59989     0.49597     0.67615     0.15146     0.29033     0.27866     0.68606     0.32546     0.32339     0.20302      0.5076     0.33687     0.19149     0.25719     0.18908     0.30233     0.35755     0.27721     0.26435     0.53092     0.31401     0.51232     0.55038     0.72615     0.72028     0.50044     0.69906     0.35213     0.32123     0.69012     0.36756     0.48528     0.66168     0.44662     0.67096      0.3526     0.70753     0.36721     0.38512     0.47331     0.41431      0.1673     0.46102     0.46634     0.20075     0.45597     0.63967     0.21855     0.63053     0.32199     0.73822     0.68061     0.55423     0.31177     0.45005     0.72211     0.31939     0.47551     0.45621     0.69738     0.44129     0.31604     0.55067     0.46463     0.50497     0.62051     0.18692     0.15922     0.18287     0.32969     0.41898     0.52619     0.66778      0.6794     0.52747     0.64459     0.33007     0.44979     0.39616     0.61227     0.17066     0.72209     0.23891     0.43846];
dend_dend_golomb_K_b = zeros(100,nstep);
dend_dend_golomb_K_b(:,1) = [0.51982     0.37035     0.31039     0.26946     0.58796     0.44549     0.29638     0.41293       0.529     0.47525     0.45304     0.44111     0.38713     0.44583     0.22339     0.56357     0.41833      0.4702     0.36408     0.23683     0.52626     0.47736     0.36852     0.53083     0.21329     0.41574     0.58067     0.51289     0.33575     0.29331     0.48217     0.20188     0.29017     0.53524     0.53614     0.59499     0.55387     0.48713     0.18276     0.29555     0.17464     0.42478     0.48366     0.24464     0.37814     0.21285     0.34272     0.15902     0.51853      0.5687     0.57809     0.35106     0.48829     0.46835     0.49581      0.3294     0.23033     0.52681     0.42517     0.34659     0.42118     0.49849      0.1746     0.35598     0.16999     0.57511     0.38906     0.22122     0.19265     0.18901     0.50323     0.53496     0.25037     0.32466      0.4059     0.23193     0.28336     0.20794     0.19122     0.53207     0.31057     0.22186     0.29586     0.19554      0.5392     0.44986      0.3396     0.24076     0.47096     0.36365     0.57329     0.23725     0.24134     0.46577     0.29608     0.21685     0.56322     0.26751     0.19284     0.18353];
dend_dend_golomb_Kdr_n = zeros(100,nstep);
dend_dend_golomb_Kdr_n(:,1) = [0.4495      0.3004     0.36179     0.25467    0.097979      0.4798     0.27063     0.18757     0.37727     0.26666     0.26882     0.32614     0.33044     0.31104     0.38716     0.48608     0.26215      0.3695     0.41713    0.086824      0.3572     0.36535     0.10527     0.41309     0.35619     0.11028     0.48677     0.24436     0.46316     0.45173     0.17905     0.26559     0.15309    0.077165     0.49759     0.21057     0.40481    0.078376     0.12655     0.48628    0.069212     0.27088     0.21642     0.10633    0.075729     0.48721       0.278     0.30348     0.38368     0.25831     0.21855     0.48201     0.10732     0.19096     0.33139     0.34949     0.13212     0.45736     0.33671     0.33054    0.058943      0.4668     0.30126    0.072241    0.090877     0.34604     0.16471     0.43869     0.42062      0.2665     0.14614     0.45439     0.33925     0.40815     0.35162     0.35929     0.40958     0.48376     0.16623     0.25997     0.10996     0.48662     0.16712     0.14784     0.10606     0.42085     0.49131    0.082135     0.17274     0.38227     0.08886     0.19572     0.21255     0.35122     0.38888     0.29136     0.48805     0.24226     0.40762      0.2031];
dend_dend_golomb_Na_h = zeros(100,nstep);
dend_dend_golomb_Na_h(:,1) = [0.43186     0.20824     0.57928     0.38586     0.51333     0.33564     0.64427     0.87158     0.20932     0.15672     0.29656     0.30438     0.35366     0.28321     0.70981     0.80506     0.38296      0.8626     0.41531     0.42047     0.48888     0.24317      0.2042     0.48177     0.15477     0.84433     0.17571    0.062837      0.6429     0.21801     0.18033     0.25512      0.2074     0.70159     0.78525      0.4081     0.47858    0.057122     0.61149     0.79552     0.21553     0.47537     0.64867     0.14274     0.79647     0.88412     0.45089     0.88338     0.36538     0.73129     0.72635     0.14915      0.4069    0.076005      0.4106     0.85568     0.86874     0.80128     0.49463     0.26822     0.45903     0.32717     0.30394     0.73387    0.096269     0.88607     0.24143     0.52076     0.59513     0.56087     0.27399      0.1317     0.17542     0.89486     0.88132     0.50569     0.46659     0.21179     0.79731        0.21     0.32713    0.087085     0.12486     0.15076     0.25719      0.6463     0.13969     0.68179     0.30658     0.24079     0.34528       0.548     0.61107     0.34026     0.67928     0.74789     0.44629     0.38189     0.38785     0.45299];
D1_V = zeros(100,nstep);
D1_V(:,1) = [-63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63];
D1_naCurrentMSN_m = zeros(100,nstep);
D1_naCurrentMSN_m(:,1) = [-0.014022   -0.010883   0.0067563   -0.016795    0.024775   0.0070394   0.0065604  -0.0069688    0.010151  -0.0082977    0.037273    -0.01109    -0.01416    0.019549     0.01445   -0.041453   -0.035576    0.019896   -0.001232     0.05664    0.047233    0.034587   -0.082227    0.058997    0.045365   -0.048622   -0.028955    0.022912    0.027964    0.014255    0.033692   0.0020171   -0.033729   0.0047889  -0.0066268   -0.043285    0.025818   -0.025926   -0.039299 -0.00067744   0.0098745   0.0086266   -0.011996    0.019157    0.090289   0.0037849    0.046001   -0.028235   -0.057185    0.043318   -0.010428   -0.063855   0.0017459  -0.0091919    0.045583   -0.040283   -0.068387    0.016216   -0.024359   -0.011012    0.018019    -0.02147    0.015147    0.032803  -0.0041336   0.0084016    0.049458   -0.030999    -0.04341    0.038442   -0.047614   -0.028519    0.013295    0.035823  -0.0051521   -0.027648    0.023017    0.026647   0.0026684  -0.0073044   -0.035233    0.021048   -0.023123    0.019037   -0.018114    0.042352    0.043368   0.0083262   -0.037297    0.041493   -0.037194   -0.022307   -0.024816    0.073637     -0.0127    0.022397    0.055994    0.041461  -0.0024118    0.058405];
D1_naCurrentMSN_h = zeros(100,nstep);
D1_naCurrentMSN_h(:,1) = [1.3368     0.21575     -0.2847    -0.48484     0.65474     -0.5585    -0.58956      0.2162      0.7752      1.1505    0.095996     0.19882    -0.72091    -0.47385    -0.19179     0.87962    -0.42545     -1.6363     0.48943    -0.79205    -0.54788    -0.42571     0.59561    -0.31317    -0.49846    -0.01961     0.38927     -1.0814    -0.29661    -0.66926     -1.2503     0.72373     -1.4212     -2.1292      0.4322     0.50451    -0.77687     -1.0521     0.25467     -1.9068    -0.96189     0.57663     0.67968      1.1952       0.265    -0.48731     0.14485    -0.81237      1.9432    -0.84896     -0.5682     -2.1362      1.0107      1.0846      1.5009     -1.0789      1.7604     -1.5408      1.1888     0.43469     -1.5221     0.49126    -0.42405    -0.69762       1.778    -0.93928   -0.063037     0.31993      -0.104    0.065875      1.2198    -0.97709     -1.3113    -0.86863    -0.77194     0.22069     0.16455      1.3644     -1.2278    -0.42205     -2.3098    -0.83605      1.7768     0.67899   -0.063182     -1.3087     -1.1551    -0.29626    -0.17062     0.43391    -0.64532      2.1458    -0.63466    -0.86728     -0.6807    -0.57244    -0.80337    -0.10036    -0.91065     0.56326];
D1_kCurrentMSN_m = zeros(100,nstep);
D1_kCurrentMSN_m(:,1) = [-0.013493   -0.018977    0.076452    0.070587   -0.049926   -0.061767  -0.0082858    0.034554    0.059064    0.052331    0.031488   -0.039026     0.13464    -0.10036    0.065983   -0.041503    0.092528   -0.022871    0.034115    0.076892    0.048094   0.0063527    0.065276   -0.054853    0.042022    -0.15152    0.014826   -0.022193   -0.067473   -0.004331    0.051356    0.044749    0.021417    -0.11539    0.057561     0.11251   -0.021737   -0.085704   0.0033241    0.027119    0.026003   -0.035896   -0.075901    0.064393   -0.035679    0.023258    -0.11906   -0.010573     0.03134   -0.062953     0.16001    0.083762   -0.052319    0.038531    0.092266   -0.055384   -0.061009   0.0043649   -0.039435    -0.02518   -0.012247   -0.087727    0.053058   -0.030081  -0.0021817    0.041498    0.028761    -0.11849    0.017023    -0.10936   -0.024797     -0.0193   -0.062479  -0.0060394  -0.0059158   -0.055162    0.062351    0.073536   -0.048233   0.0019085   -0.037872    0.044813  -0.0050066    0.034151   -0.027308   -0.084574   -0.024726   -0.013678    0.048987    0.053503   -0.069019    0.009346    0.047962   -0.013087    -0.04954  -0.0066598  -0.0036811     0.02972    0.044781   -0.034272];
D1_mCurrentMSN_m = zeros(100,nstep);
D1_mCurrentMSN_m(:,1) = [0.043248    0.035334    0.019132   -0.028077   0.0050007    0.022763    0.037167   -0.047917  -0.0022476  -0.0028254   -0.018538    0.026477    0.031862     0.02514   0.0081541   0.0018016   -0.024116   -0.024712   -0.028627    0.027235    0.010091   0.0072674    0.028771  -0.0013351   0.0064582    0.017151   -0.014292  -0.0077834    0.063527   -0.018747  -0.0053659 -0.00076257    0.012579   0.0082392    0.040338  -0.0081202    0.024678   0.0041736  -0.0047621   0.0073274    -0.02182    0.068945    0.048044   -0.016894    -0.02477     0.03647   -0.003605  -0.0054022    0.015153 -0.00042934   -0.028139   -0.014686   -0.027519     0.01043   0.0030471  -0.0031391    0.019022   0.0024495   -0.010971   0.0073002    0.016629   -0.033639    0.019818    0.017403   0.0033009   -0.045571    0.001644   -0.020075    0.028137   0.0070189  0.00020351     0.01972   -0.018397    0.010166   -0.016714    0.012317   0.0016174    0.023604   -0.044844    0.050622   -0.045326   -0.012421    0.041523   0.0064116   -0.016217    0.016606    -0.05584   -0.014768    0.012874    0.021865     0.04777  -0.0078578    0.041361    0.016324   -0.036365   -0.031069   -0.017711   0.0053614   -0.010448   0.0061748];
soma_D1_soma_MSN_iSYN_s = zeros(100,nstep);
soma_D1_soma_MSN_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
D1_D1_gabaRecInputMSN_s = zeros(100,nstep);
D1_D1_gabaRecInputMSN_s(:,1) = [0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001];
D2_V = zeros(100,nstep);
D2_V(:,1) = [-63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63];
D2_naCurrentMSN_m = zeros(100,nstep);
D2_naCurrentMSN_m(:,1) = [-0.066242    0.030526   -0.024076    0.025023   -0.011586  -0.0039683    0.021896    0.021982   -0.026444   -0.032863   -0.039741    0.052754    -0.02247 -0.00026849    0.044626    0.014391    0.049518   -0.014614  -0.0095066    0.025482   0.0070038   -0.040474   -0.019602  -0.0092997   -0.041378   -0.022987   0.0021851    0.053781    -0.05888   -0.010905    0.020439   -0.025384   -0.008865   -0.012643   0.0071358   -0.013013  -0.0059225   -0.006734   -0.012667    0.023392    -0.03727     0.04021   -0.011151    0.036334   -0.014725   0.0046114    0.054312   -0.053176   -0.045638    0.034168   -0.051981  -0.0029569   0.0021054   0.0073049    0.066652    0.045408    0.022922  -0.0083942    0.048834   -0.034228  -0.0049667    0.017378    0.020772  -0.0014509    0.015665   -0.045924    0.063204   -0.032318   -0.021751   -0.014505    0.022041    0.027154   -0.013084    0.021703    0.025291     0.02323   -0.006618    0.023102    0.044038   -0.043669   -0.040395    0.018307   -0.017722   -0.030121   0.0016737   -0.036143   -0.028002   -0.033495    0.059192    0.011063  -0.0047738    0.072339  -0.0053778   -0.018529   -0.047689   -0.019733   0.0054317   -0.036181    0.047424   -0.012755];
D2_naCurrentMSN_h = zeros(100,nstep);
D2_naCurrentMSN_h(:,1) = [-0.7736    -0.19814    -0.62357      1.9335     0.69258     -1.0388    -0.31801    -0.38383     0.18799    0.082795    -0.92005     0.25249     0.42045   -0.069686     0.36007    -0.50752     0.54968     0.74491     -0.5186    -0.49331     -0.8881      -2.083     -1.9555      1.3493      1.2774      1.1314     -0.4328     0.56197      1.9472     -2.1202    -0.61665    -0.61744    -0.21436    -0.55524      0.9797      2.0611    -0.17678     0.89645    0.015921    -0.72614     0.43917    -0.80509    -0.76276   -0.049928     -1.1359   0.0057944      1.4391    -0.24069     -2.4416    0.040826     0.40377     -0.3198    0.010063     0.69481    0.063315     0.31546      1.0375      0.3458   -0.047025     0.65243     0.63747      1.5433    0.079705     0.32115     0.76327     0.33707     0.63366      2.0626    -0.32324      1.5079    -0.88965    -0.25521      1.4855     0.94529     0.68615     0.94002     -1.4323     0.75028       1.347    -0.89764    0.077714     0.52198    -0.60869     -1.6291     0.07703  -0.0087548    -0.80761     0.26035    -0.98754     -0.6121    -0.46814    -0.41787     -2.0924   -0.044476     0.21899     -2.6325    0.061292    -0.76326    -0.28087     0.65364];
D2_kCurrentMSN_m = zeros(100,nstep);
D2_kCurrentMSN_m(:,1) = [-0.039004    0.056953   -0.027605    0.044322    -0.09559    0.018346   0.0054558   -0.026477    -0.10906   -0.056053    0.011287    0.015426     0.10278    0.026681    0.018664    -0.03115   -0.033506   -0.039786   -0.004083  -0.0047066   -0.014906    -0.10305   -0.023888   -0.076417     0.10544      0.0736   -0.042092    0.079424    -0.11461  -0.0040116   -0.019646  -0.0030789   -0.026003   -0.083056   -0.030008   -0.050734    0.040937   -0.028076     0.10417   -0.036697   -0.058062     0.13295    0.078044     0.10909    -0.13208   -0.048711     0.05907    0.006174      0.1113     -0.1282  -0.0094916   -0.049688    0.069295     -0.1148   -0.091391    0.037402     0.13359    0.055973   -0.013436    0.056146    0.066272    0.011197   -0.082985   -0.018836  -0.0053706    0.068088   -0.049346    0.033232    0.022394  -0.0095307     0.15738   -0.037664   -0.012861    0.055338    -0.10326   -0.020992    0.057099   -0.020049  -0.0011779   -0.010886    0.082013  -0.0054564    0.031609    0.083162    0.090603    0.081833    -0.02309   -0.022425    0.042113     -0.1075   0.0053976   -0.045561    0.054755   -0.087492   -0.003701   -0.021167   -0.074539     0.05233     0.14478   -0.061571];
D2_mCurrentMSN_m = zeros(100,nstep);
D2_mCurrentMSN_m(:,1) = [0.0097574  -0.0072288     0.01045   0.0044755    0.013168   -0.034886   -0.023343   -0.006145    0.022655    0.004618  -0.0050714   -0.012973   -0.069454  -0.0027412   -0.048916   -0.024743   -0.013021   -0.029959    0.013341    0.014625   0.0063609  -0.0089533   0.0047231   -0.028289 -4.2117e-06    0.013181    0.010213    0.043309    0.007499   -0.011261  0.00048146   -0.017409   -0.014247   -0.036021    0.023546    0.018695   -0.025095   -0.006152   -0.038978   -0.041279   -0.031571   -0.027923    0.033507   0.0076583   0.0081143   -0.038206   -0.011419   -0.025267  -0.0073747 -0.00099008 -0.00049137  -0.0074644   -0.020298   -0.010727    0.027936   -0.035375   0.0087885   0.0092606    0.015166    0.012998  -0.0044509     -0.0265    0.035093   -0.026807  -0.0051426   -0.004602   0.0041146   -0.037174   0.0035415    0.025268   0.0061576  -0.0069321    0.016169  -0.0098271    0.015498   -0.032985    0.016917   -0.019064  -0.0059136   -0.021909   -0.031596   -0.014566    0.014639     0.01377    0.027931    0.037177    0.020849   -0.023345  -0.0089542    0.020015 -0.00061028   0.0045442     0.03736    0.013526   0.0089638  -0.0042015   0.0062961    0.027867    0.055731    0.031529];
soma_D2_soma_MSN_iSYN_s = zeros(100,nstep);
soma_D2_soma_MSN_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
D2_D2_gabaRecInputMSN_s = zeros(100,nstep);
D2_D2_gabaRecInputMSN_s(:,1) = [0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001];
tstart = tic;
for k=2:nstep
  t=T(k-1);
  soma_v1=((-((8).*(soma_soma_golomb_K_a(:,k-1).^3).*soma_soma_golomb_K_b(:,k-1).*(soma_v(:,k-1)-(-90))))+((-((225).*(soma_soma_golomb_Kdr_n(:,k-1).^(2)).*(soma_v(:,k-1)-(-90))))+((-((112).*soma_soma_golomb_Na_h(:,k-1).*((1./(1+exp(-(soma_v(:,k-1)-(-24))./11.5))).^3).*(soma_v(:,k-1)-(50))))+((((0)))+((-((0.03)*(soma_v(:,k-1)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*soma_soma_soma_soma_iSYN_s(:,k-1)).*(soma_v(:,k-1)-(-80)))))+((((0.15).*sum((((dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1)))'-(soma_v(:,k-1)*ones(1,size(soma_v(:,k-1),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a1=((1./(1+exp(-(soma_v(:,k-1)+50)./20)))-soma_soma_golomb_K_a(:,k-1))./2;
  soma_soma_golomb_K_b1=((1./(1+exp(-(soma_v(:,k-1)+70)./-6)))-soma_soma_golomb_K_b(:,k-1))./(120);
  soma_soma_golomb_Kdr_n1=((1./(1+exp(-(soma_v(:,k-1)+12.4)./6.8)))-soma_soma_golomb_Kdr_n(:,k-1))./((1)*(0.087+11.4./(1+exp((soma_v(:,k-1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-(soma_v(:,k-1)-1.3)./18.7))));
  soma_soma_golomb_Na_h1=((1./(1+exp(-(soma_v(:,k-1)+58.3)./-6.7)))-soma_soma_golomb_Na_h(:,k-1))./(0.5 + 14./(1+exp(-(soma_v(:,k-1)+60)./-12)));
  soma_soma_soma_soma_iSYN_s1=-soma_soma_soma_soma_iSYN_s(:,k-1)./(13) + ((1-soma_soma_soma_soma_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  dend_v1=((-(dend_dend_golomb_K_gd_dend.*(dend_dend_golomb_K_a(:,k-1).^3).*dend_dend_golomb_K_b(:,k-1).*(dend_v(:,k-1)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*(dend_dend_golomb_Kdr_n(:,k-1).^(2)).*(dend_v(:,k-1)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*dend_dend_golomb_Na_h(:,k-1).*((1./(1+exp(-(dend_v(:,k-1)-(-24))./11.5))).^3).*(dend_v(:,k-1)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*(dend_v(:,k-1)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*(dend_v(:,k-1) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*(dend_v(:,k-1) - (-85)))))+((((0.15).*sum((((soma_v(:,k-1)*ones(1,size(soma_v(:,k-1),1)))'-(dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum((((dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1)))'-(dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a1=((1./(1+exp(-(dend_v(:,k-1)+50)./20)))-dend_dend_golomb_K_a(:,k-1))./2;
  dend_dend_golomb_K_b1=((1./(1+exp(-(dend_v(:,k-1)+70)./-6)))-dend_dend_golomb_K_b(:,k-1))./(120);
  dend_dend_golomb_Kdr_n1=((1./(1+exp(-(dend_v(:,k-1)+12.4)./6.8)))-dend_dend_golomb_Kdr_n(:,k-1))./((1)*(0.087+11.4./(1+exp((dend_v(:,k-1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-(dend_v(:,k-1)-1.3)./18.7))));
  dend_dend_golomb_Na_h1=((1./(1+exp(-(dend_v(:,k-1)+58.3)./-6.7)))-dend_dend_golomb_Na_h(:,k-1))./(0.5 + 14./(1+exp(-(dend_v(:,k-1)+60)./-12)));
  D1_V1=(((-((100)*D1_naCurrentMSN_m(:,k-1).^3.*D1_naCurrentMSN_h(:,k-1).*(D1_V(:,k-1)-(50))))+((-((80)*D1_kCurrentMSN_m(:,k-1).^4.*(D1_V(:,k-1)-(-100))))+((-((1.3)*D1_mCurrentMSN_m(:,k-1).*(D1_V(:,k-1)-(-100))))+((-((0.1)*(D1_V(:,k-1)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*soma_D1_soma_MSN_iSYN_s(:,k-1)).*(D1_V(:,k-1)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*D1_D1_gabaRecInputMSN_s(:,k-1)).*(D1_V(:,k-1)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m1=(0.32*(D1_V(:,k-1)+54)./(1-exp(-(D1_V(:,k-1)+54)/4))).*(1-D1_naCurrentMSN_m(:,k-1))-(0.28*(D1_V(:,k-1)+27)./(exp((D1_V(:,k-1)+27)/5)-1)).*D1_naCurrentMSN_m(:,k-1);
  D1_naCurrentMSN_h1=(0.128*exp(-(D1_V(:,k-1)+50)/18)).*(1-D1_naCurrentMSN_h(:,k-1))-(4./(1+exp(-(D1_V(:,k-1)+27)/5))).*D1_naCurrentMSN_h(:,k-1);
  D1_kCurrentMSN_m1=(0.032*(D1_V(:,k-1)+52)./(1-exp(-(D1_V(:,k-1)+52)/5))).*(1-D1_kCurrentMSN_m(:,k-1))-(0.5*exp(-(D1_V(:,k-1)+57)/40)).*D1_kCurrentMSN_m(:,k-1);
  D1_mCurrentMSN_m1=(D1_mCurrentMSN_Qs*1e-4*(D1_V(:,k-1)-(-30))./(1-exp(-(D1_V(:,k-1)-(-30))/9))).*(1-D1_mCurrentMSN_m(:,k-1)) - (-D1_mCurrentMSN_Qs*1e-4*(D1_V(:,k-1)-(-30))./(1-exp((D1_V(:,k-1)-(-30))/9))).*D1_mCurrentMSN_m(:,k-1);
  soma_D1_soma_MSN_iSYN_s1=-soma_D1_soma_MSN_iSYN_s(:,k-1)./(13) + ((1-soma_D1_soma_MSN_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  D1_D1_gabaRecInputMSN_s1=-D1_D1_gabaRecInputMSN_s(:,k-1)./(13) + 2*(1+tanh(D1_V(:,k-1)/4)).*(1-D1_D1_gabaRecInputMSN_s(:,k-1));
  D2_V1=(((-((100)*D2_naCurrentMSN_m(:,k-1).^3.*D2_naCurrentMSN_h(:,k-1).*(D2_V(:,k-1)-(50))))+((-((80)*D2_kCurrentMSN_m(:,k-1).^4.*(D2_V(:,k-1)-(-100))))+((-((1.3)*D2_mCurrentMSN_m(:,k-1).*(D2_V(:,k-1)-(-100))))+((-((0.1)*(D2_V(:,k-1)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*soma_D2_soma_MSN_iSYN_s(:,k-1)).*(D2_V(:,k-1)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*D2_D2_gabaRecInputMSN_s(:,k-1)).*(D2_V(:,k-1)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m1=(0.32*(D2_V(:,k-1)+54)./(1-exp(-(D2_V(:,k-1)+54)/4))).*(1-D2_naCurrentMSN_m(:,k-1))-(0.28*(D2_V(:,k-1)+27)./(exp((D2_V(:,k-1)+27)/5)-1)).*D2_naCurrentMSN_m(:,k-1);
  D2_naCurrentMSN_h1=(0.128*exp(-(D2_V(:,k-1)+50)/18)).*(1-D2_naCurrentMSN_h(:,k-1))-(4./(1+exp(-(D2_V(:,k-1)+27)/5))).*D2_naCurrentMSN_h(:,k-1);
  D2_kCurrentMSN_m1=(0.032*(D2_V(:,k-1)+52)./(1-exp(-(D2_V(:,k-1)+52)/5))).*(1-D2_kCurrentMSN_m(:,k-1))-(0.5*exp(-(D2_V(:,k-1)+57)/40)).*D2_kCurrentMSN_m(:,k-1);
  D2_mCurrentMSN_m1=(D2_mCurrentMSN_Qs*1e-4*(D2_V(:,k-1)-(-30))./(1-exp(-(D2_V(:,k-1)-(-30))/9))).*(1-D2_mCurrentMSN_m(:,k-1)) - (-D2_mCurrentMSN_Qs*1e-4*(D2_V(:,k-1)-(-30))./(1-exp((D2_V(:,k-1)-(-30))/9))).*D2_mCurrentMSN_m(:,k-1);
  soma_D2_soma_MSN_iSYN_s1=-soma_D2_soma_MSN_iSYN_s(:,k-1)./(13) + ((1-soma_D2_soma_MSN_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  D2_D2_gabaRecInputMSN_s1=-D2_D2_gabaRecInputMSN_s(:,k-1)./(13) + 2*(1+tanh(D2_V(:,k-1)/4)).*(1-D2_D2_gabaRecInputMSN_s(:,k-1));
  t=t+0.5*dt;
  soma_v2=((-((8).*((soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a1).^3).*(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b1).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n1).^(2)).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h1).*((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)-(-24))./11.5))).^3).*((soma_v(:,k-1)+.5*dt*soma_v1)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+.5*dt*soma_v1)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1)).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1)))'-((soma_v(:,k-1)+.5*dt*soma_v1)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v1),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a1))./2;
  soma_soma_golomb_K_b2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b1))./(120);
  soma_soma_golomb_Kdr_n2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n1))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+.5*dt*soma_v1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)-1.3)./18.7))));
  soma_soma_golomb_Na_h2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h1))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+60)./-12)));
  soma_soma_soma_soma_iSYN_s2=-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  dend_v2=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a1).^3).*(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b1).*((dend_v(:,k-1)+.5*dt*dend_v1)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n1).^(2)).*((dend_v(:,k-1)+.5*dt*dend_v1)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h1).*((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)-(-24))./11.5))).^3).*((dend_v(:,k-1)+.5*dt*dend_v1)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+.5*dt*dend_v1)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v1) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v1) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+.5*dt*soma_v1)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v1),1)))'-((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1)))'-((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a1))./2;
  dend_dend_golomb_K_b2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b1))./(120);
  dend_dend_golomb_Kdr_n2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n1))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+.5*dt*dend_v1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)-1.3)./18.7))));
  dend_dend_golomb_Na_h2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h1))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+60)./-12)));
  D1_V2=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1).^3.*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1).*((D1_V(:,k-1)+.5*dt*D1_V1)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1).^4.*((D1_V(:,k-1)+.5*dt*D1_V1)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-100))))+((-((0.1)*((D1_V(:,k-1)+.5*dt*D1_V1)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1)).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1)).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m2=(0.32*((D1_V(:,k-1)+.5*dt*D1_V1)+54)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1))-(0.28*((D1_V(:,k-1)+.5*dt*D1_V1)+27)./(exp(((D1_V(:,k-1)+.5*dt*D1_V1)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1);
  D1_naCurrentMSN_h2=(0.128*exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1))-(4./(1+exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1);
  D1_kCurrentMSN_m2=(0.032*((D1_V(:,k-1)+.5*dt*D1_V1)+52)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1))-(0.5*exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1);
  D1_mCurrentMSN_m2=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))./(1-exp(((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1);
  soma_D1_soma_MSN_iSYN_s2=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  D1_D1_gabaRecInputMSN_s2=-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1)./(13) + 2*(1+tanh((D1_V(:,k-1)+.5*dt*D1_V1)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1));
  D2_V2=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1).^3.*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1).*((D2_V(:,k-1)+.5*dt*D2_V1)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1).^4.*((D2_V(:,k-1)+.5*dt*D2_V1)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-100))))+((-((0.1)*((D2_V(:,k-1)+.5*dt*D2_V1)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1)).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1)).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m2=(0.32*((D2_V(:,k-1)+.5*dt*D2_V1)+54)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1))-(0.28*((D2_V(:,k-1)+.5*dt*D2_V1)+27)./(exp(((D2_V(:,k-1)+.5*dt*D2_V1)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1);
  D2_naCurrentMSN_h2=(0.128*exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1))-(4./(1+exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1);
  D2_kCurrentMSN_m2=(0.032*((D2_V(:,k-1)+.5*dt*D2_V1)+52)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1))-(0.5*exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1);
  D2_mCurrentMSN_m2=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))./(1-exp(((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1);
  soma_D2_soma_MSN_iSYN_s2=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  D2_D2_gabaRecInputMSN_s2=-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1)./(13) + 2*(1+tanh((D2_V(:,k-1)+.5*dt*D2_V1)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1));
  soma_v3=((-((8).*((soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a2).^3).*(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b2).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n2).^(2)).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h2).*((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)-(-24))./11.5))).^3).*((soma_v(:,k-1)+.5*dt*soma_v2)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+.5*dt*soma_v2)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2)).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1)))'-((soma_v(:,k-1)+.5*dt*soma_v2)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v2),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a2))./2;
  soma_soma_golomb_K_b3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b2))./(120);
  soma_soma_golomb_Kdr_n3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n2))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+.5*dt*soma_v2)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)-1.3)./18.7))));
  soma_soma_golomb_Na_h3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h2))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+60)./-12)));
  soma_soma_soma_soma_iSYN_s3=-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  dend_v3=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a2).^3).*(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b2).*((dend_v(:,k-1)+.5*dt*dend_v2)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n2).^(2)).*((dend_v(:,k-1)+.5*dt*dend_v2)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h2).*((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)-(-24))./11.5))).^3).*((dend_v(:,k-1)+.5*dt*dend_v2)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+.5*dt*dend_v2)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v2) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v2) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+.5*dt*soma_v2)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v2),1)))'-((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1)))'-((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a2))./2;
  dend_dend_golomb_K_b3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b2))./(120);
  dend_dend_golomb_Kdr_n3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n2))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+.5*dt*dend_v2)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)-1.3)./18.7))));
  dend_dend_golomb_Na_h3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h2))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+60)./-12)));
  D1_V3=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2).^3.*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2).*((D1_V(:,k-1)+.5*dt*D1_V2)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2).^4.*((D1_V(:,k-1)+.5*dt*D1_V2)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-100))))+((-((0.1)*((D1_V(:,k-1)+.5*dt*D1_V2)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2)).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2)).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m3=(0.32*((D1_V(:,k-1)+.5*dt*D1_V2)+54)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2))-(0.28*((D1_V(:,k-1)+.5*dt*D1_V2)+27)./(exp(((D1_V(:,k-1)+.5*dt*D1_V2)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2);
  D1_naCurrentMSN_h3=(0.128*exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2))-(4./(1+exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2);
  D1_kCurrentMSN_m3=(0.032*((D1_V(:,k-1)+.5*dt*D1_V2)+52)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2))-(0.5*exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2);
  D1_mCurrentMSN_m3=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))./(1-exp(((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2);
  soma_D1_soma_MSN_iSYN_s3=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  D1_D1_gabaRecInputMSN_s3=-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2)./(13) + 2*(1+tanh((D1_V(:,k-1)+.5*dt*D1_V2)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2));
  D2_V3=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2).^3.*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2).*((D2_V(:,k-1)+.5*dt*D2_V2)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2).^4.*((D2_V(:,k-1)+.5*dt*D2_V2)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-100))))+((-((0.1)*((D2_V(:,k-1)+.5*dt*D2_V2)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2)).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2)).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m3=(0.32*((D2_V(:,k-1)+.5*dt*D2_V2)+54)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2))-(0.28*((D2_V(:,k-1)+.5*dt*D2_V2)+27)./(exp(((D2_V(:,k-1)+.5*dt*D2_V2)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2);
  D2_naCurrentMSN_h3=(0.128*exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2))-(4./(1+exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2);
  D2_kCurrentMSN_m3=(0.032*((D2_V(:,k-1)+.5*dt*D2_V2)+52)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2))-(0.5*exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2);
  D2_mCurrentMSN_m3=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))./(1-exp(((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2);
  soma_D2_soma_MSN_iSYN_s3=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  D2_D2_gabaRecInputMSN_s3=-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2)./(13) + 2*(1+tanh((D2_V(:,k-1)+.5*dt*D2_V2)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2));
  t=t+0.5*dt;
  soma_v4=((-((8).*((soma_soma_golomb_K_a(:,k-1)+dt*soma_soma_golomb_K_a3).^3).*(soma_soma_golomb_K_b(:,k-1)+dt*soma_soma_golomb_K_b3).*((soma_v(:,k-1)+dt*soma_v3)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+dt*soma_soma_golomb_Kdr_n3).^(2)).*((soma_v(:,k-1)+dt*soma_v3)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+dt*soma_soma_golomb_Na_h3).*((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)-(-24))./11.5))).^3).*((soma_v(:,k-1)+dt*soma_v3)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+dt*soma_v3)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3)).*((soma_v(:,k-1)+dt*soma_v3)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1)))'-((soma_v(:,k-1)+dt*soma_v3)*ones(1,size((soma_v(:,k-1)+dt*soma_v3),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+dt*soma_soma_golomb_K_a3))./2;
  soma_soma_golomb_K_b4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+dt*soma_soma_golomb_K_b3))./(120);
  soma_soma_golomb_Kdr_n4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+dt*soma_soma_golomb_Kdr_n3))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+dt*soma_v3)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)-1.3)./18.7))));
  soma_soma_golomb_Na_h4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+dt*soma_soma_golomb_Na_h3))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+60)./-12)));
  soma_soma_soma_soma_iSYN_s4=-(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  dend_v4=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+dt*dend_dend_golomb_K_a3).^3).*(dend_dend_golomb_K_b(:,k-1)+dt*dend_dend_golomb_K_b3).*((dend_v(:,k-1)+dt*dend_v3)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+dt*dend_dend_golomb_Kdr_n3).^(2)).*((dend_v(:,k-1)+dt*dend_v3)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+dt*dend_dend_golomb_Na_h3).*((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)-(-24))./11.5))).^3).*((dend_v(:,k-1)+dt*dend_v3)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+dt*dend_v3)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+dt*dend_v3) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+dt*dend_v3) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+dt*soma_v3)*ones(1,size((soma_v(:,k-1)+dt*soma_v3),1)))'-((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1)))'-((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+dt*dend_dend_golomb_K_a3))./2;
  dend_dend_golomb_K_b4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+dt*dend_dend_golomb_K_b3))./(120);
  dend_dend_golomb_Kdr_n4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+dt*dend_dend_golomb_Kdr_n3))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+dt*dend_v3)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)-1.3)./18.7))));
  dend_dend_golomb_Na_h4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+dt*dend_dend_golomb_Na_h3))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+60)./-12)));
  D1_V4=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3).^3.*(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3).*((D1_V(:,k-1)+dt*D1_V3)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3).^4.*((D1_V(:,k-1)+dt*D1_V3)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3).*((D1_V(:,k-1)+dt*D1_V3)-(-100))))+((-((0.1)*((D1_V(:,k-1)+dt*D1_V3)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3)).*((D1_V(:,k-1)+dt*D1_V3)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3)).*((D1_V(:,k-1)+dt*D1_V3)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m4=(0.32*((D1_V(:,k-1)+dt*D1_V3)+54)./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3))-(0.28*((D1_V(:,k-1)+dt*D1_V3)+27)./(exp(((D1_V(:,k-1)+dt*D1_V3)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3);
  D1_naCurrentMSN_h4=(0.128*exp(-((D1_V(:,k-1)+dt*D1_V3)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3))-(4./(1+exp(-((D1_V(:,k-1)+dt*D1_V3)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3);
  D1_kCurrentMSN_m4=(0.032*((D1_V(:,k-1)+dt*D1_V3)+52)./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3))-(0.5*exp(-((D1_V(:,k-1)+dt*D1_V3)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3);
  D1_mCurrentMSN_m4=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+dt*D1_V3)-(-30))./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+dt*D1_V3)-(-30))./(1-exp(((D1_V(:,k-1)+dt*D1_V3)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3);
  soma_D1_soma_MSN_iSYN_s4=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  D1_D1_gabaRecInputMSN_s4=-(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3)./(13) + 2*(1+tanh((D1_V(:,k-1)+dt*D1_V3)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3));
  D2_V4=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3).^3.*(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3).*((D2_V(:,k-1)+dt*D2_V3)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3).^4.*((D2_V(:,k-1)+dt*D2_V3)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3).*((D2_V(:,k-1)+dt*D2_V3)-(-100))))+((-((0.1)*((D2_V(:,k-1)+dt*D2_V3)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(1)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3)).*((D2_V(:,k-1)+dt*D2_V3)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3)).*((D2_V(:,k-1)+dt*D2_V3)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m4=(0.32*((D2_V(:,k-1)+dt*D2_V3)+54)./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3))-(0.28*((D2_V(:,k-1)+dt*D2_V3)+27)./(exp(((D2_V(:,k-1)+dt*D2_V3)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3);
  D2_naCurrentMSN_h4=(0.128*exp(-((D2_V(:,k-1)+dt*D2_V3)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3))-(4./(1+exp(-((D2_V(:,k-1)+dt*D2_V3)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3);
  D2_kCurrentMSN_m4=(0.032*((D2_V(:,k-1)+dt*D2_V3)+52)./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3))-(0.5*exp(-((D2_V(:,k-1)+dt*D2_V3)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3);
  D2_mCurrentMSN_m4=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+dt*D2_V3)-(-30))./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+dt*D2_V3)-(-30))./(1-exp(((D2_V(:,k-1)+dt*D2_V3)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3);
  soma_D2_soma_MSN_iSYN_s4=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  D2_D2_gabaRecInputMSN_s4=-(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3)./(13) + 2*(1+tanh((D2_V(:,k-1)+dt*D2_V3)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3));
  soma_v(:,k) = soma_v(:,k-1) + (dt/6)*(soma_v1+2*(soma_v2+soma_v3)+soma_v4);
  soma_soma_golomb_K_a(:,k) = soma_soma_golomb_K_a(:,k-1) + (dt/6)*(soma_soma_golomb_K_a1+2*(soma_soma_golomb_K_a2+soma_soma_golomb_K_a3)+soma_soma_golomb_K_a4);
  soma_soma_golomb_K_b(:,k) = soma_soma_golomb_K_b(:,k-1) + (dt/6)*(soma_soma_golomb_K_b1+2*(soma_soma_golomb_K_b2+soma_soma_golomb_K_b3)+soma_soma_golomb_K_b4);
  soma_soma_golomb_Kdr_n(:,k) = soma_soma_golomb_Kdr_n(:,k-1) + (dt/6)*(soma_soma_golomb_Kdr_n1+2*(soma_soma_golomb_Kdr_n2+soma_soma_golomb_Kdr_n3)+soma_soma_golomb_Kdr_n4);
  soma_soma_golomb_Na_h(:,k) = soma_soma_golomb_Na_h(:,k-1) + (dt/6)*(soma_soma_golomb_Na_h1+2*(soma_soma_golomb_Na_h2+soma_soma_golomb_Na_h3)+soma_soma_golomb_Na_h4);
  soma_soma_soma_soma_iSYN_s(:,k) = soma_soma_soma_soma_iSYN_s(:,k-1) + (dt/6)*(soma_soma_soma_soma_iSYN_s1+2*(soma_soma_soma_soma_iSYN_s2+soma_soma_soma_soma_iSYN_s3)+soma_soma_soma_soma_iSYN_s4);
  dend_v(:,k) = dend_v(:,k-1) + (dt/6)*(dend_v1+2*(dend_v2+dend_v3)+dend_v4);
  dend_dend_golomb_K_a(:,k) = dend_dend_golomb_K_a(:,k-1) + (dt/6)*(dend_dend_golomb_K_a1+2*(dend_dend_golomb_K_a2+dend_dend_golomb_K_a3)+dend_dend_golomb_K_a4);
  dend_dend_golomb_K_b(:,k) = dend_dend_golomb_K_b(:,k-1) + (dt/6)*(dend_dend_golomb_K_b1+2*(dend_dend_golomb_K_b2+dend_dend_golomb_K_b3)+dend_dend_golomb_K_b4);
  dend_dend_golomb_Kdr_n(:,k) = dend_dend_golomb_Kdr_n(:,k-1) + (dt/6)*(dend_dend_golomb_Kdr_n1+2*(dend_dend_golomb_Kdr_n2+dend_dend_golomb_Kdr_n3)+dend_dend_golomb_Kdr_n4);
  dend_dend_golomb_Na_h(:,k) = dend_dend_golomb_Na_h(:,k-1) + (dt/6)*(dend_dend_golomb_Na_h1+2*(dend_dend_golomb_Na_h2+dend_dend_golomb_Na_h3)+dend_dend_golomb_Na_h4);
  D1_V(:,k) = D1_V(:,k-1) + (dt/6)*(D1_V1+2*(D1_V2+D1_V3)+D1_V4);
  D1_naCurrentMSN_m(:,k) = D1_naCurrentMSN_m(:,k-1) + (dt/6)*(D1_naCurrentMSN_m1+2*(D1_naCurrentMSN_m2+D1_naCurrentMSN_m3)+D1_naCurrentMSN_m4);
  D1_naCurrentMSN_h(:,k) = D1_naCurrentMSN_h(:,k-1) + (dt/6)*(D1_naCurrentMSN_h1+2*(D1_naCurrentMSN_h2+D1_naCurrentMSN_h3)+D1_naCurrentMSN_h4);
  D1_kCurrentMSN_m(:,k) = D1_kCurrentMSN_m(:,k-1) + (dt/6)*(D1_kCurrentMSN_m1+2*(D1_kCurrentMSN_m2+D1_kCurrentMSN_m3)+D1_kCurrentMSN_m4);
  D1_mCurrentMSN_m(:,k) = D1_mCurrentMSN_m(:,k-1) + (dt/6)*(D1_mCurrentMSN_m1+2*(D1_mCurrentMSN_m2+D1_mCurrentMSN_m3)+D1_mCurrentMSN_m4);
  soma_D1_soma_MSN_iSYN_s(:,k) = soma_D1_soma_MSN_iSYN_s(:,k-1) + (dt/6)*(soma_D1_soma_MSN_iSYN_s1+2*(soma_D1_soma_MSN_iSYN_s2+soma_D1_soma_MSN_iSYN_s3)+soma_D1_soma_MSN_iSYN_s4);
  D1_D1_gabaRecInputMSN_s(:,k) = D1_D1_gabaRecInputMSN_s(:,k-1) + (dt/6)*(D1_D1_gabaRecInputMSN_s1+2*(D1_D1_gabaRecInputMSN_s2+D1_D1_gabaRecInputMSN_s3)+D1_D1_gabaRecInputMSN_s4);
  D2_V(:,k) = D2_V(:,k-1) + (dt/6)*(D2_V1+2*(D2_V2+D2_V3)+D2_V4);
  D2_naCurrentMSN_m(:,k) = D2_naCurrentMSN_m(:,k-1) + (dt/6)*(D2_naCurrentMSN_m1+2*(D2_naCurrentMSN_m2+D2_naCurrentMSN_m3)+D2_naCurrentMSN_m4);
  D2_naCurrentMSN_h(:,k) = D2_naCurrentMSN_h(:,k-1) + (dt/6)*(D2_naCurrentMSN_h1+2*(D2_naCurrentMSN_h2+D2_naCurrentMSN_h3)+D2_naCurrentMSN_h4);
  D2_kCurrentMSN_m(:,k) = D2_kCurrentMSN_m(:,k-1) + (dt/6)*(D2_kCurrentMSN_m1+2*(D2_kCurrentMSN_m2+D2_kCurrentMSN_m3)+D2_kCurrentMSN_m4);
  D2_mCurrentMSN_m(:,k) = D2_mCurrentMSN_m(:,k-1) + (dt/6)*(D2_mCurrentMSN_m1+2*(D2_mCurrentMSN_m2+D2_mCurrentMSN_m3)+D2_mCurrentMSN_m4);
  soma_D2_soma_MSN_iSYN_s(:,k) = soma_D2_soma_MSN_iSYN_s(:,k-1) + (dt/6)*(soma_D2_soma_MSN_iSYN_s1+2*(soma_D2_soma_MSN_iSYN_s2+soma_D2_soma_MSN_iSYN_s3)+soma_D2_soma_MSN_iSYN_s4);
  D2_D2_gabaRecInputMSN_s(:,k) = D2_D2_gabaRecInputMSN_s(:,k-1) + (dt/6)*(D2_D2_gabaRecInputMSN_s1+2*(D2_D2_gabaRecInputMSN_s2+D2_D2_gabaRecInputMSN_s3)+D2_D2_gabaRecInputMSN_s4);
  if any(k == enableLog)
    elapsedTime = toc(tstart);
    elapsedTimeMinutes = floor(elapsedTime/60);
    elapsedTimeSeconds = rem(elapsedTime,60);
    if elapsedTimeMinutes
        fprintf('Processed %g of %g ms (elapsed time: %g m %.3f s)\n',T(k),T(end),elapsedTimeMinutes,elapsedTimeSeconds);
    else
        fprintf('Processed %g of %g ms (elapsed time: %.3f s)\n',T(k),T(end),elapsedTimeSeconds);
    end
  end
end
Y=cat(1,soma_v,soma_soma_golomb_K_a,soma_soma_golomb_K_b,soma_soma_golomb_Kdr_n,soma_soma_golomb_Na_h,soma_soma_soma_soma_iSYN_s,dend_v,dend_dend_golomb_K_a,dend_dend_golomb_K_b,dend_dend_golomb_Kdr_n,dend_dend_golomb_Na_h,D1_V,D1_naCurrentMSN_m,D1_naCurrentMSN_h,D1_kCurrentMSN_m,D1_mCurrentMSN_m,soma_D1_soma_MSN_iSYN_s,D1_D1_gabaRecInputMSN_s,D2_V,D2_naCurrentMSN_m,D2_naCurrentMSN_h,D2_kCurrentMSN_m,D2_mCurrentMSN_m,soma_D2_soma_MSN_iSYN_s,D2_D2_gabaRecInputMSN_s)';
