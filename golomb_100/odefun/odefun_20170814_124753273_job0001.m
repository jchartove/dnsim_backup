function [Y,T] = odefun_20170814_124753273_job0001
tspan=[0 2000]; dt=0.01;
T=tspan(1):dt:tspan(2); nstep=length(T);
nreports = 5; tmp = 1:(nstep-1)/nreports:nstep; enableLog = tmp(2:end);
fprintf('\nThe odefun file used is: odefun_20170814_124753273_job0001 \n');
fprintf('\nSimulation interval: %g-%g\n',tspan(1),tspan(2));
fprintf('Starting integration (rk4, dt=%g)\n',dt);
soma_soma_soma_soma_iSYN_gsyn2 = (0.08) - (0).*((0.08) - 0.005);
soma_soma_soma_soma_iSYN_width = inf;
soma_soma_soma_soma_iSYN_Nmax = max((100),(100));
soma_soma_soma_soma_iSYN_srcpos = linspace(1,soma_soma_soma_soma_iSYN_Nmax,(100))'*ones(1,(100));
soma_soma_soma_soma_iSYN_dstpos = (linspace(1,soma_soma_soma_soma_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_soma_soma_soma_iSYN_mask = genmask((100),(100),(0.3),soma_soma_soma_soma_iSYN_gsyn2,1,1,0);
dend_soma_dend_soma_iCOM_compcon = eye((100),(100));
dend_dend_golomb_K_gd_dend = (8)/10;
dend_dend_golomb_Kdr_gkdr_dend = (225)/10;
dend_dend_golomb_Na_gna_dend = (112)/10;
dend_dend_input_tonic2 = (0) + 10.*(0);
dend_dend_iMultiPoissonExp_Ge = corr_Poisson((100), (50), (2), (1), (1), 2, .5, (2000), (0.01), (0));
dend_dend_iMultiPoissonExp_Gi = corr_Poisson((100), (0), (2), (1), (1), 5, .5, (2000), (0.01), (0));
soma_dend_soma_dend_iCOM_compcon = eye((100),(100));
dend_dend_dend_dend_iGAP_g_GAP2 = (0.04) + (0).*(0.4-(0.04));
dend_dend_dend_dend_iGAP_Nmax = max((100),(100));
dend_dend_dend_dend_iGAP_Xpre = linspace(1,dend_dend_dend_dend_iGAP_Nmax,(100))'*ones(1,(100));
dend_dend_dend_dend_iGAP_Xpost = (linspace(1,dend_dend_dend_dend_iGAP_Nmax,(100))'*ones(1,(100)))';
dend_dend_dend_dend_iGAP_mask = genmask((100),(100),(0.3),dend_dend_dend_dend_iGAP_g_GAP2,0,1,0);
D1_naCurrentMSN_V_IC = -63+63*randn((100),1);
D1_kCurrentMSN_V_IC = -63+63*randn((100),1);
D1_mCurrentMSN_Qs = (2.3)^(.1*(37-23));
D1_mCurrentMSN_V_IC = -63+63*randn((100),1);
D1_injectedCurrentD1_freq = 1/(2*pi);
soma_D1_soma_MSN_iSYN_indegree = (0.1)*((100)-(0));
soma_D1_soma_MSN_iSYN_gsyn2 = (10*(0.01))/(soma_D1_soma_MSN_iSYN_indegree+1);
soma_D1_soma_MSN_iSYN_width = inf;
soma_D1_soma_MSN_iSYN_Nmax = max((100),(100));
soma_D1_soma_MSN_iSYN_srcpos = linspace(1,soma_D1_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100));
soma_D1_soma_MSN_iSYN_dstpos = (linspace(1,soma_D1_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_D1_soma_MSN_iSYN_mask = genmask((100),(100),(0.1),soma_D1_soma_MSN_iSYN_gsyn2,1,0,(0));
D1_D1_gabaRecInputMSN_netcon = ones((100))-eye((100));
D2_naCurrentMSN_V_IC = -63+63*randn((100),1);
D2_kCurrentMSN_V_IC = -63+63*randn((100),1);
D2_mCurrentMSN_Qs = (2.3)^(.1*(37-23));
D2_mCurrentMSN_V_IC = -63+63*randn((100),1);
D2_injectedCurrentD2_freq = 1/(2*pi);
soma_D2_soma_MSN_iSYN_indegree = (0.1)*((100)-(0));
soma_D2_soma_MSN_iSYN_gsyn2 = (10*(0.01))/(soma_D2_soma_MSN_iSYN_indegree+1);
soma_D2_soma_MSN_iSYN_width = inf;
soma_D2_soma_MSN_iSYN_Nmax = max((100),(100));
soma_D2_soma_MSN_iSYN_srcpos = linspace(1,soma_D2_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100));
soma_D2_soma_MSN_iSYN_dstpos = (linspace(1,soma_D2_soma_MSN_iSYN_Nmax,(100))'*ones(1,(100)))';
soma_D2_soma_MSN_iSYN_mask = genmask((100),(100),(0.1),soma_D2_soma_MSN_iSYN_gsyn2,1,0,(0));
D2_D2_gabaRecInputMSN_netcon = ones((100))-eye((100));
soma_v = zeros(100,nstep);
soma_v(:,1) = [-53.4738     -48.0193     -38.2845     -21.4796      -29.539     -11.6812     -16.7314     -39.0005     -36.8042     -9.82596     -31.9217     -11.3027     -31.5288     -21.2161     -53.1986     -22.4418     -8.49204      -12.873    -0.359103     -41.8775     -69.6526     -3.55011      -75.964     -75.4632     -5.10688     -72.6685     -69.4262     -10.6913     -83.7838      -55.741     -77.6089     -87.6299     -67.8891     -7.99472     -76.9857     -81.8508     -31.2836     -24.2287     -83.9495     -34.6441     -6.58859     -28.9207     -30.4485     -13.2246     -69.9752     -29.3998     -39.5234     -79.1468     -16.6639     -49.7256      -17.006     -81.5479     -40.8749     -9.82797     -2.46199     -63.9216     -7.86683     -10.4584     -39.5103     -15.7059     -84.7518     -38.3451    -0.478408     -35.2602     -14.7337     -82.8083     -19.7334     -35.5816     -22.2767     -77.5994     -44.9546     -16.6711     -44.2021     -67.7887     -66.4297     -4.15536     -13.7557      -32.947     -42.4599     -6.25024     -5.18381     -25.1121     -24.6946     -51.2215     -47.2812     -7.77097     -41.6183     -1.90336     -7.18007     -37.7421     -34.5932     -26.9393     -16.9569     -53.2173     -28.1344     -4.64284     -30.9018     -10.6979     -5.29999     -13.1649];
soma_soma_golomb_K_a = zeros(100,nstep);
soma_soma_golomb_K_a(:,1) = [0.43381     0.69441     0.56569     0.54798     0.32734     0.56296     0.40222     0.36533     0.42017     0.29758     0.29852     0.21219     0.24932     0.62158     0.41726      0.2024     0.28327     0.59735     0.59036     0.44637      0.7066     0.21366     0.24687     0.38206      0.4567     0.59516      0.5385     0.73432     0.70887     0.53087     0.50337     0.29108     0.72807     0.74668     0.30516     0.25782     0.49873     0.63806     0.67217     0.50866     0.25505      0.6395     0.19699     0.22674     0.73937     0.41589     0.53374      0.1564      0.7294     0.70778     0.25036     0.73431     0.70448     0.74752     0.40418      0.4227     0.34234      0.4225     0.19985     0.23955     0.48029     0.19062     0.45292     0.65743     0.18123     0.56154     0.63059     0.46171     0.66618     0.67574     0.71268     0.74582     0.22166     0.66802     0.70284     0.17071     0.56918     0.43116     0.56103     0.32025     0.67377     0.27968     0.31063     0.61976     0.63166     0.61101     0.23393     0.58437     0.50533     0.44487     0.27992     0.50268     0.25259     0.57025     0.34003     0.65789     0.17205     0.48221     0.70047     0.54099];
soma_soma_golomb_K_b = zeros(100,nstep);
soma_soma_golomb_K_b(:,1) = [0.22075     0.27893     0.58053     0.18239     0.32126     0.49061     0.42239     0.35464     0.44285     0.48352     0.56361      0.5975     0.34116     0.17508     0.33867     0.19877     0.45975     0.25328     0.38358     0.47815     0.20277     0.33181     0.45164     0.35412     0.37507     0.42736      0.1874     0.34511     0.34833     0.48707      0.4864     0.48736     0.59191     0.27133       0.397     0.51268     0.58576     0.44888     0.44052      0.5816     0.37208     0.55119     0.38054     0.25561     0.51641     0.46868     0.54995     0.23828     0.25399     0.40971     0.33464     0.40135     0.29163     0.42528     0.56354     0.56094     0.23854      0.3125     0.37154     0.42542     0.32789     0.59148     0.22893     0.28879     0.22811     0.52604      0.4961      0.3427     0.51346     0.25237     0.30888     0.21922     0.55675      0.5074     0.16277     0.57775     0.18984      0.4265     0.45348     0.19079      0.3651     0.56825     0.15218     0.26122      0.5114     0.52145     0.53965     0.38936     0.50054     0.54476     0.18484     0.58582     0.44796     0.21701     0.45862     0.58008     0.35901     0.58207     0.58023     0.59371];
soma_soma_golomb_Kdr_n = zeros(100,nstep);
soma_soma_golomb_Kdr_n(:,1) = [0.17957      0.1894    0.095043     0.22312     0.31283    0.064172      0.2159     0.20458      0.3288     0.47816     0.07999     0.44011     0.41684     0.38107     0.35763     0.47667     0.46052     0.17727     0.39363      0.4923     0.34207    0.096917     0.17384     0.19474     0.12468     0.26964     0.18828      0.2923     0.40941     0.14097     0.16793     0.42487    0.079322     0.13098     0.37757     0.27569     0.48772    0.097612     0.45695     0.24181     0.36721     0.39802     0.15974    0.060733     0.19826     0.13368     0.30264      0.2112     0.26502     0.32923    0.055511      0.3131     0.18535     0.10892     0.09838     0.10762     0.21271    0.077272     0.18081      0.4246     0.19388     0.19315     0.48076     0.11224    0.080547     0.19168     0.47124    0.070766     0.47152     0.47846     0.23975     0.26367     0.43951     0.10133     0.30059     0.35055     0.30203     0.22311     0.40408     0.40206     0.12626     0.43219     0.25529     0.34221     0.17005     0.32907     0.28664     0.47757    0.094657     0.35582     0.40007     0.45191     0.33097     0.10684      0.1888     0.46607     0.22343     0.31434     0.48969     0.28053];
soma_soma_golomb_Na_h = zeros(100,nstep);
soma_soma_golomb_Na_h(:,1) = [0.39735     0.87286     0.12672     0.41312     0.79499      0.6405     0.77361     0.53936     0.82393    0.095952      0.3093     0.73046      0.2565     0.48875     0.11108     0.53556    0.078416     0.47061     0.37368    0.088134     0.33331     0.86379     0.66369     0.39798     0.33094     0.78483     0.55369     0.68385      0.7114    0.094505     0.20298     0.50763     0.37512     0.51862     0.70789     0.28705     0.69375     0.82774     0.34323     0.88811     0.56447     0.32961     0.31151     0.70289     0.60846     0.13312     0.21944     0.43005     0.48026     0.68337     0.56524      0.6478     0.74052     0.29708     0.46405     0.64321     0.73589     0.67602     0.79237     0.63038     0.30656     0.10774     0.35282     0.36909     0.44615     0.54575     0.54244     0.78531      0.1552     0.73387     0.48485     0.89183     0.73705     0.42323     0.88609     0.31422     0.80109     0.32867     0.81073    0.079294     0.80942     0.14559     0.64194     0.58325     0.24061     0.82111     0.27917     0.41051      0.7783     0.48742     0.42777     0.35196     0.29754     0.84885    0.078767    0.078026      0.7145     0.73109     0.48423     0.12717];
soma_soma_soma_soma_iSYN_s = zeros(100,nstep);
soma_soma_soma_soma_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
dend_v = zeros(100,nstep);
dend_v(:,1) = [-89.6718     -68.6063     -71.0393     -51.5458     -79.2392     -9.94709     -44.5788     -35.4249     -46.5677     -26.7543     -44.7963     -42.9272      -31.871     -68.3301     -68.2946     -55.5797     -59.6303     -86.3162     -53.7894     -18.5453     -88.1825     -11.8338     -4.72777     -73.5167     -41.9473     -45.1928     -47.5603      -64.052     -36.0208     -74.3881     -36.9112     -55.5423     -56.1993     -25.2699     -63.3939     -41.3959     -45.8389     -38.7663     -73.4312     -84.1595     -32.9491     -9.95316     -45.4823     -11.5245      -47.785     -43.8083     -72.5969     -9.16471     -1.28442     -60.2147     -22.1364     -45.4821     -32.9683     -65.0819     -30.5668     -88.9279     -6.25683     -37.0692     -2.32731     -2.05392     -73.5047     -18.1104     -87.3037     -78.9678     -54.2134     -45.9224     -52.5833     -82.7791      -54.154     -89.7713     -62.5391     -30.7363     -87.1392     -83.3444     -54.1343     -60.9517     -55.5221     -89.5575      -17.802     -25.6279     -81.1094     -8.00632      -9.7238     -24.2791     -66.4907     -41.7745     -12.2168     -29.5117     -56.6961     -47.2206     -70.7763     -68.8882     -86.0544     -9.61732      -44.134     -40.4155     -86.6623     -89.8773     -42.8743     -10.7313];
dend_dend_golomb_K_a = zeros(100,nstep);
dend_dend_golomb_K_a(:,1) = [0.62237     0.74396     0.61011       0.314      0.5622     0.51875     0.33325     0.42456     0.35349     0.29745     0.47888     0.28359     0.62713     0.44918     0.40669     0.69414     0.39832     0.21634     0.50595     0.72531     0.62412      0.6192     0.19715     0.62289     0.28293     0.42194     0.45915     0.69275     0.46586     0.35459     0.67341     0.37065     0.56827     0.36523     0.38178     0.19997     0.20369     0.65323     0.61655     0.67331     0.33631      0.6706     0.28957     0.16512     0.67572      0.3212     0.63882     0.16148     0.31733     0.53185     0.28277     0.51644     0.34138     0.58861     0.20993     0.19589     0.38347     0.48814     0.49325     0.56909     0.26487     0.44477     0.21304     0.34079     0.35833     0.46042     0.27101     0.59028     0.51834     0.51511      0.6049       0.591      0.4183     0.15013     0.54889     0.34706     0.68683     0.26592     0.15256     0.52385     0.62741     0.52221     0.35926       0.389     0.31697     0.17007     0.37926     0.62578     0.37196     0.37027     0.68178     0.60454     0.70823     0.71543     0.71694     0.57811      0.5598     0.21219     0.68862     0.42922];
dend_dend_golomb_K_b = zeros(100,nstep);
dend_dend_golomb_K_b(:,1) = [0.5374      0.5679     0.17699     0.42815     0.28084     0.26655      0.4589     0.19939     0.49867     0.53451     0.29061     0.17355     0.41815     0.22796     0.59357     0.39707      0.2074     0.24756     0.43984     0.46909     0.20859     0.35463     0.42615     0.16088     0.47519     0.33191     0.28179     0.15904     0.59804     0.21352     0.24667     0.36766     0.20311     0.37392      0.3254     0.21234      0.4247     0.32504     0.36544     0.57161     0.33558     0.54469     0.25552     0.21601     0.25018     0.50907     0.43578     0.46164     0.24554     0.37915     0.16667     0.45088      0.5189     0.45778     0.22527     0.17762     0.58651     0.48264     0.17213     0.16764     0.48827     0.52031     0.49825     0.28231      0.5191     0.27575     0.20456     0.48889     0.22369     0.53212     0.46408     0.35176     0.42237     0.55585     0.24339     0.22178      0.2595     0.43611     0.52334      0.4995     0.19582     0.42996     0.24373     0.39689     0.28591     0.16348     0.38448     0.45635     0.49211     0.20034     0.52396     0.35189      0.5241     0.42967     0.59471     0.39259     0.41576     0.21283     0.17237     0.45233];
dend_dend_golomb_Kdr_n = zeros(100,nstep);
dend_dend_golomb_Kdr_n(:,1) = [0.23719    0.063538      0.2951      0.1178    0.079233     0.35891     0.17114     0.40669     0.12712     0.48245     0.13398     0.30282     0.10049     0.42229     0.11319     0.23037     0.46953     0.12181     0.45952     0.26528    0.070974     0.27433     0.43372      0.2779     0.39632     0.49444     0.44917      0.4853      0.3169     0.44206     0.14368     0.47664     0.44944     0.29772     0.12098     0.48162     0.49303     0.24013     0.21149     0.37187     0.30805        0.21      0.2367     0.25221     0.44351     0.45659     0.16025      0.1492     0.21565     0.28529    0.068404       0.138     0.19414     0.26254     0.37935     0.23423     0.46352     0.10911    0.052628     0.34877     0.15837     0.24539     0.45768    0.088177    0.068624     0.39396     0.49381     0.19882     0.20392     0.18263     0.34705     0.16053     0.37164     0.42371    0.077806     0.43135     0.46023     0.35029     0.23226    0.073326     0.15025     0.37499     0.49979     0.33785     0.47531     0.39216     0.10558      0.4399     0.35921     0.13802    0.076417     0.46952     0.12927      0.4657      0.3845     0.24463     0.38599     0.21374      0.3731     0.29792];
dend_dend_golomb_Na_h = zeros(100,nstep);
dend_dend_golomb_Na_h(:,1) = [0.32281     0.68349     0.56756     0.79311     0.66625     0.50176     0.87235     0.76351     0.53834     0.44372     0.81778     0.19163     0.14914     0.30072     0.43179     0.42668      0.4945     0.65749     0.53471      0.3901     0.57353     0.33624     0.53427     0.05924    0.073132     0.37546     0.54805     0.26531     0.23964     0.76513     0.78954    0.061441     0.26983     0.59093     0.43401     0.34123    0.084901     0.68378     0.50641     0.88613      0.7298     0.35777     0.83052      0.3016     0.05597     0.52178     0.30562     0.24571     0.87131      0.2445    0.051275     0.81924     0.17015     0.70264    0.087185     0.44246     0.57886     0.60663     0.40259     0.14718     0.84162     0.50289     0.70758     0.72642     0.68389     0.67852     0.88837     0.26473     0.68183     0.43132     0.89195     0.27145     0.32462    0.051975     0.53146     0.86546     0.82566     0.12149     0.77712     0.68896     0.47041     0.14909    0.086782     0.20099     0.49919     0.45931     0.83672     0.19245     0.58135     0.75061     0.58576     0.51057     0.11216      0.8932     0.23723     0.50378     0.55379     0.10143     0.24848    0.091907];
D1_V = zeros(100,nstep);
D1_V(:,1) = [-63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63];
D1_naCurrentMSN_m = zeros(100,nstep);
D1_naCurrentMSN_m(:,1) = [-0.013901    0.023086   0.0020179    0.020832  -0.0052667   -0.026907   -0.033254   -0.069504  -0.0082507   -0.011472  -0.0092721  -0.0016683  -0.0033775    0.042372  -0.0030668   -0.021865     0.01185    0.026134     0.05659   -0.019853  -0.0045084  8.4967e-05   -0.031856   -0.011619  -0.0047545   -0.022227  -0.0061539   -0.018504   -0.056377    0.028634    0.037367    0.043068    0.032637    0.039658    0.051926    -0.04638   -0.043422  -0.0041795  -0.0094837   -0.043544  -0.0093491    -0.05615   -0.031828   -0.042468    0.029431   -0.018696    0.062223    0.037665    0.033589   -0.006489   -0.034219   -0.021163    0.099306  0.00099008   -0.049337   0.0027074    0.011105   -0.019714  0.00010591    0.051948    -0.01631    0.037256   -0.012794    0.028418   -0.042248  -0.0081579    -0.01632    0.029127    0.016709    -0.06607    0.068803   -0.010277  -0.0048594    0.002737   0.0044837   -0.026274    0.010075   -0.024755   -0.018992   -0.072228   -0.047715     0.01158  -0.0030494   -0.021209   -0.004792   0.0017583    0.046625    0.047186   -0.055046   -0.036927   -0.040828   -0.038869    0.022536    0.054306   -0.025185  -0.0019927     0.03537   0.0064842    0.015313    0.010998];
D1_naCurrentMSN_h = zeros(100,nstep);
D1_naCurrentMSN_h(:,1) = [-0.46261     0.75053    -0.41085    -0.94188    0.001682      1.2073     0.28316    -0.35358     -1.5199    0.027506     -1.1064    -0.73922    -0.65899     -1.3398   -0.037218     0.15193     0.99135    -0.22526     0.75641      1.0761     0.68775     -1.2378     -1.3429      1.3389     0.30159     -0.8385     -1.6497    -0.18257     0.18971      0.6459    -0.81307    -0.88952     0.12218     0.41559    -0.21421     -2.2538     0.63585    -0.36874      1.4207     0.41712    -0.74317   -0.029407    0.096133     0.91472     0.20794     -0.6063    -0.73913    -0.57278    -0.32942    -0.31427     -1.2944      1.5581   -0.017408    -0.74574      0.2368    -0.45892    -0.73885     0.16787     0.22896      -1.811   0.0079515     0.12773      1.2934     0.64051     0.10374    -0.88028      1.4972     0.49954    -0.36436     0.54619     -1.5332    -0.58921      1.0675     0.83356    -0.12088     0.92635    -0.38218     -1.9243    -0.13926     -1.0033     -1.7805    -0.64981     0.86595    -0.96042     0.35728     0.53847     -1.5842    -0.60334    -0.53687    -0.82553    -0.24523     -1.0706      2.0834    -0.59199      1.5979    -0.87595     -1.2945     0.92371      1.0329     0.96954];
D1_kCurrentMSN_m = zeros(100,nstep);
D1_kCurrentMSN_m(:,1) = [-0.0086151   -0.082081   -0.051702   -0.024351     0.13862    0.033553  -0.0042659   -0.097231     0.12446    -0.10259   -0.023363    0.017125   -0.055287    -0.15207    -0.13161   -0.013805    0.080639    0.090798  -0.0056411   -0.044945    0.087068   -0.060994   -0.053404    -0.12571    0.020875  -0.0029969   -0.045746    0.035082   -0.018181   0.0078369      0.0195    0.052179    0.032104    0.063307    0.031823   0.0027362    0.077734     0.17553   -0.014811      0.1222    0.020982   -0.064832   -0.068404   -0.021488    -0.06317   -0.020319     0.17248     0.15797   -0.048862    -0.20787    0.044492    0.022032   -0.085433    0.087821     0.16028   -0.022284   -0.015245  -0.0042786   -0.032707   -0.075767   -0.046553    0.066556  -0.0025983   -0.020829    0.036303   -0.038623    0.034839    0.018031     0.07169    0.043891     0.16564    0.032676    -0.11009   -0.010563    -0.11223     0.13371   0.0022746    0.010417   0.0026916     0.13544    0.023288    0.065825   -0.016388    0.012286  -0.0063436   -0.086617    0.034254   -0.017122   -0.022577   -0.063901    -0.20378    0.062353    0.066679    0.022177    0.018339    0.090384    0.055217   -0.019002   -0.037565    -0.10065];
D1_mCurrentMSN_m = zeros(100,nstep);
D1_mCurrentMSN_m(:,1) = [-0.009062   0.0052007     -0.0208   -0.018841   0.0084544   -0.016841    0.028719   -0.036271    0.010204    0.031032   -0.018161   -0.016279   -0.052296  0.00089995  -0.0028911    0.028454   -0.004795    0.029972    0.052945  -0.0038774   -0.003072    0.036023   0.0067522   0.0063541  -0.0004979    -0.01964  -0.0020493    0.040739    0.032819   -0.016863    0.032126    -0.05894    0.024863    0.002734    0.017454    0.021906    0.026055    0.014221    0.025549    0.038066   -0.059804   -0.037502   -0.011061    0.017242   -0.011357    -0.03834    0.026384   -0.015985    0.043812  -0.0016191   -0.021343   0.0055065    -0.02089   -0.014581    0.010883   0.0058869  0.00021023    0.013655    0.018543   0.0098725   -0.013532  -0.0091984   -0.012987  -0.0072775   -0.041501    0.031722    0.045229   -0.024981    -0.03808  -0.0024793  -0.0027311   0.0091251  -0.0058559  -0.0060827    0.047896    0.017233   0.0027138    0.021304   -0.014429   0.0026782    0.021367   0.0011582  -0.0022361    0.012179    0.012917   -0.035273    0.017455    -0.03264    0.026738 -0.00081708   -0.001877   0.0011405  -0.0078512   0.0082918   -0.019025   0.0060931   -0.014532    0.026384   -0.067938   -0.013246];
soma_D1_soma_MSN_iSYN_s = zeros(100,nstep);
soma_D1_soma_MSN_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
D1_D1_gabaRecInputMSN_s = zeros(100,nstep);
D1_D1_gabaRecInputMSN_s(:,1) = [0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001];
D2_V = zeros(100,nstep);
D2_V(:,1) = [-63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63 -63];
D2_naCurrentMSN_m = zeros(100,nstep);
D2_naCurrentMSN_m(:,1) = [0.0078163    0.027834    0.051934    0.063356    0.045254    0.001062   0.0092183    0.012837   -0.019083   -0.018524   -0.027511   -0.052047   -0.036131    0.009926   -0.038252   -0.010843   -0.023596   -0.017929     0.03344   -0.063934   -0.024889    0.044446   -0.028592   -0.026824   -0.024298   -0.027984  -0.0049027   0.0034949   0.0071648     0.06868  -0.0077816   0.0066085   -0.048078    -0.02584      0.0627   -0.053682     0.03449   0.0036103   -0.027599   0.0029552  -0.0048921   -0.011305    0.022619   -0.032067   -0.010052   0.0063617    0.067955    0.018435   0.0086911    0.033753   -0.011481   -0.031735  -0.0095089   -0.013045   -0.013114    0.036013   -0.038466   -0.051403   0.0049015    0.042764   -0.029066    0.044073    0.014666     0.03377    0.027999   -0.032351    0.040578   -0.029561    0.030715   -0.030825 -0.00026145    0.031181   -0.036348   -0.022274  -0.0029717  -0.0028023  0.00022464    0.011788    0.018715   0.0099471   -0.033196   -0.022025 -0.00038557     0.04894    0.033456    0.029064   -0.017279    0.045804    0.014408   -0.015932    0.026624  -0.0089081    0.058093    -0.06635    0.049411    0.014793   -0.012824    0.043182   -0.013437    0.010495];
D2_naCurrentMSN_h = zeros(100,nstep);
D2_naCurrentMSN_h(:,1) = [-0.2878    -0.25091     0.23092     0.49198     0.66752     -1.3903      1.4082     -1.5691     0.57758      1.3483     0.85572      1.4724    -0.13481    -0.77606    -0.18941     -1.3882     0.98623    -0.54452      1.2794   -0.086085     0.45621    -0.18877    -0.75175    -0.30036     -1.2698      2.3042      1.5208      0.3272     0.20128      1.3149     0.54579    -0.71491      0.5167     -1.7319     0.62373    0.006392    -0.42192     -1.2919     0.68341    -0.34104    -0.46348      1.1714     -1.4477     0.34036      1.9259    -0.37006     0.58434    -0.41146      2.0199    0.039564     0.12727      1.0831    -0.37165     -3.4833      0.1629   0.0080327      1.0868      1.1197     -2.3441     0.58426      1.1149     -1.1268     0.46468     0.77967     -1.0385     0.86364     0.72457      1.5208    -0.43396    -0.32126     -1.4198     -1.6495     0.88384     0.40753    -0.51112     0.74408     0.11723      1.2231   -0.090999     -1.1351   -0.083684    -0.37989   -0.032447     0.37895      1.6812    -0.13449     -2.3246     -1.5629      1.1547    0.060517      2.0244     0.67347     0.45805      1.3523    -0.48353    -0.13599      1.0118     -1.3838     0.06367     0.03868];
D2_kCurrentMSN_m = zeros(100,nstep);
D2_kCurrentMSN_m(:,1) = [0.024234   -0.018732     0.10168   0.0069771   -0.096245   -0.019138  -0.0078999    0.021593    0.032557      0.1462     0.01025   -0.014934   -0.016913   -0.077505   -0.056703   -0.086927     0.18449   -0.044049     0.10118     0.08123    0.074285    -0.10136       0.116    0.050905     0.10811   -0.010622    0.071047   -0.012067   0.0017678   -0.030041     0.07731   -0.064473    -0.11217     0.12125    0.048821    0.072999   -0.036834   -0.045333     0.14617     -0.1884    -0.10759     0.07141   -0.061998   -0.049093   0.0086764    0.013645     0.18888    0.020559    0.035006   -0.019225   -0.083211   -0.012409    -0.04766       0.178   0.0062296    0.084916  0.00030133    0.083644    -0.03503    0.031363  -0.0077006   -0.020989   -0.034276     -0.0784     0.08208    0.055278    -0.11082  -0.0062488     0.01459    0.044224    -0.06992    0.098943   -0.046916   -0.061536    0.014676     0.04517   0.0059756     0.02294     0.18984    -0.17709     -0.1333   -0.047282   -0.064236    -0.04071    0.046919    0.051791     0.10755   -0.062825     0.11759    0.061522    0.061725  0.00045648    -0.03478    0.018747    0.048435   0.0032823    0.060848     0.11376    -0.15395     0.03473];
D2_mCurrentMSN_m = zeros(100,nstep);
D2_mCurrentMSN_m(:,1) = [0.016689   -0.051557   -0.032565    0.002923    0.017039   -0.014867   -0.017942    0.017107    0.033553    0.037334  -0.0051776    0.014406  -0.0027563   -0.028247   -0.029218   0.0062141    0.012103   0.0028368     0.00898    0.024558    0.017444  -0.0013161    0.023864  -0.0047859    0.019677    0.015916  -0.0001003   -0.017932    0.022215   -0.015515   0.0049814   0.0040801   0.0025242    -0.01647   -0.021374  -0.0048845   -0.054598   -0.036286   -0.020024    0.036429   -0.012093    0.013005     0.02176   -0.020534   -0.019591   -0.037407    0.026288   -0.041117   -0.029823   0.0034063   -0.020761   -0.027996     -0.0437    0.024991    0.038934   -0.059693  -0.0074572  -0.0080135   0.0066367   0.0034647    -0.04396    0.029529    0.027992  -0.0066342    0.011516    0.048825    0.021889   -0.015015    0.023246    0.037814    0.016964  -0.0064688   -0.016171      0.0343   -0.023113   -0.041135   -0.047831   -0.023504    0.011899   -0.013034    0.010656   0.0021296   -0.033827    0.040016    0.017839    0.011105   -0.013556  -0.0021559    0.012735   -0.012122   -0.017285    0.036632  -0.0027327    0.023334    0.031023    0.025638   -0.033243    0.028968   -0.019948    0.060641];
soma_D2_soma_MSN_iSYN_s = zeros(100,nstep);
soma_D2_soma_MSN_iSYN_s(:,1) = [0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1         0.1];
D2_D2_gabaRecInputMSN_s = zeros(100,nstep);
D2_D2_gabaRecInputMSN_s(:,1) = [0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001      0.0001];
tstart = tic;
for k=2:nstep
  t=T(k-1);
  soma_v1=((-((8).*(soma_soma_golomb_K_a(:,k-1).^3).*soma_soma_golomb_K_b(:,k-1).*(soma_v(:,k-1)-(-90))))+((-((225).*(soma_soma_golomb_Kdr_n(:,k-1).^(2)).*(soma_v(:,k-1)-(-90))))+((-((112).*soma_soma_golomb_Na_h(:,k-1).*((1./(1+exp(-(soma_v(:,k-1)-(-24))./11.5))).^3).*(soma_v(:,k-1)-(50))))+((((0)))+((-((0.03)*(soma_v(:,k-1)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*soma_soma_soma_soma_iSYN_s(:,k-1)).*(soma_v(:,k-1)-(-80)))))+((((0.15).*sum((((dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1)))'-(soma_v(:,k-1)*ones(1,size(soma_v(:,k-1),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a1=((1./(1+exp(-(soma_v(:,k-1)+50)./20)))-soma_soma_golomb_K_a(:,k-1))./2;
  soma_soma_golomb_K_b1=((1./(1+exp(-(soma_v(:,k-1)+70)./-6)))-soma_soma_golomb_K_b(:,k-1))./(120);
  soma_soma_golomb_Kdr_n1=((1./(1+exp(-(soma_v(:,k-1)+12.4)./6.8)))-soma_soma_golomb_Kdr_n(:,k-1))./((1)*(0.087+11.4./(1+exp((soma_v(:,k-1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-(soma_v(:,k-1)-1.3)./18.7))));
  soma_soma_golomb_Na_h1=((1./(1+exp(-(soma_v(:,k-1)+58.3)./-6.7)))-soma_soma_golomb_Na_h(:,k-1))./(0.5 + 14./(1+exp(-(soma_v(:,k-1)+60)./-12)));
  soma_soma_soma_soma_iSYN_s1=-soma_soma_soma_soma_iSYN_s(:,k-1)./(13) + ((1-soma_soma_soma_soma_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  dend_v1=((-(dend_dend_golomb_K_gd_dend.*(dend_dend_golomb_K_a(:,k-1).^3).*dend_dend_golomb_K_b(:,k-1).*(dend_v(:,k-1)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*(dend_dend_golomb_Kdr_n(:,k-1).^(2)).*(dend_v(:,k-1)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*dend_dend_golomb_Na_h(:,k-1).*((1./(1+exp(-(dend_v(:,k-1)-(-24))./11.5))).^3).*(dend_v(:,k-1)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*(dend_v(:,k-1)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*(dend_v(:,k-1) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*(dend_v(:,k-1) - (-85)))))+((((0.15).*sum((((soma_v(:,k-1)*ones(1,size(soma_v(:,k-1),1)))'-(dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum((((dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1)))'-(dend_v(:,k-1)*ones(1,size(dend_v(:,k-1),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a1=((1./(1+exp(-(dend_v(:,k-1)+50)./20)))-dend_dend_golomb_K_a(:,k-1))./2;
  dend_dend_golomb_K_b1=((1./(1+exp(-(dend_v(:,k-1)+70)./-6)))-dend_dend_golomb_K_b(:,k-1))./(120);
  dend_dend_golomb_Kdr_n1=((1./(1+exp(-(dend_v(:,k-1)+12.4)./6.8)))-dend_dend_golomb_Kdr_n(:,k-1))./((1)*(0.087+11.4./(1+exp((dend_v(:,k-1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-(dend_v(:,k-1)-1.3)./18.7))));
  dend_dend_golomb_Na_h1=((1./(1+exp(-(dend_v(:,k-1)+58.3)./-6.7)))-dend_dend_golomb_Na_h(:,k-1))./(0.5 + 14./(1+exp(-(dend_v(:,k-1)+60)./-12)));
  D1_V1=(((-((100)*D1_naCurrentMSN_m(:,k-1).^3.*D1_naCurrentMSN_h(:,k-1).*(D1_V(:,k-1)-(50))))+((-((80)*D1_kCurrentMSN_m(:,k-1).^4.*(D1_V(:,k-1)-(-100))))+((-((1.3)*D1_mCurrentMSN_m(:,k-1).*(D1_V(:,k-1)-(-100))))+((-((0.1)*(D1_V(:,k-1)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*soma_D1_soma_MSN_iSYN_s(:,k-1)).*(D1_V(:,k-1)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*D1_D1_gabaRecInputMSN_s(:,k-1)).*(D1_V(:,k-1)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m1=(0.32*(D1_V(:,k-1)+54)./(1-exp(-(D1_V(:,k-1)+54)/4))).*(1-D1_naCurrentMSN_m(:,k-1))-(0.28*(D1_V(:,k-1)+27)./(exp((D1_V(:,k-1)+27)/5)-1)).*D1_naCurrentMSN_m(:,k-1);
  D1_naCurrentMSN_h1=(0.128*exp(-(D1_V(:,k-1)+50)/18)).*(1-D1_naCurrentMSN_h(:,k-1))-(4./(1+exp(-(D1_V(:,k-1)+27)/5))).*D1_naCurrentMSN_h(:,k-1);
  D1_kCurrentMSN_m1=(0.032*(D1_V(:,k-1)+52)./(1-exp(-(D1_V(:,k-1)+52)/5))).*(1-D1_kCurrentMSN_m(:,k-1))-(0.5*exp(-(D1_V(:,k-1)+57)/40)).*D1_kCurrentMSN_m(:,k-1);
  D1_mCurrentMSN_m1=(D1_mCurrentMSN_Qs*1e-4*(D1_V(:,k-1)-(-30))./(1-exp(-(D1_V(:,k-1)-(-30))/9))).*(1-D1_mCurrentMSN_m(:,k-1)) - (-D1_mCurrentMSN_Qs*1e-4*(D1_V(:,k-1)-(-30))./(1-exp((D1_V(:,k-1)-(-30))/9))).*D1_mCurrentMSN_m(:,k-1);
  soma_D1_soma_MSN_iSYN_s1=-soma_D1_soma_MSN_iSYN_s(:,k-1)./(13) + ((1-soma_D1_soma_MSN_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  D1_D1_gabaRecInputMSN_s1=-D1_D1_gabaRecInputMSN_s(:,k-1)./(13) + 2*(1+tanh(D1_V(:,k-1)/4)).*(1-D1_D1_gabaRecInputMSN_s(:,k-1));
  D2_V1=(((-((100)*D2_naCurrentMSN_m(:,k-1).^3.*D2_naCurrentMSN_h(:,k-1).*(D2_V(:,k-1)-(50))))+((-((80)*D2_kCurrentMSN_m(:,k-1).^4.*(D2_V(:,k-1)-(-100))))+((-((1.3)*D2_mCurrentMSN_m(:,k-1).*(D2_V(:,k-1)-(-100))))+((-((0.1)*(D2_V(:,k-1)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*soma_D2_soma_MSN_iSYN_s(:,k-1)).*(D2_V(:,k-1)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*D2_D2_gabaRecInputMSN_s(:,k-1)).*(D2_V(:,k-1)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m1=(0.32*(D2_V(:,k-1)+54)./(1-exp(-(D2_V(:,k-1)+54)/4))).*(1-D2_naCurrentMSN_m(:,k-1))-(0.28*(D2_V(:,k-1)+27)./(exp((D2_V(:,k-1)+27)/5)-1)).*D2_naCurrentMSN_m(:,k-1);
  D2_naCurrentMSN_h1=(0.128*exp(-(D2_V(:,k-1)+50)/18)).*(1-D2_naCurrentMSN_h(:,k-1))-(4./(1+exp(-(D2_V(:,k-1)+27)/5))).*D2_naCurrentMSN_h(:,k-1);
  D2_kCurrentMSN_m1=(0.032*(D2_V(:,k-1)+52)./(1-exp(-(D2_V(:,k-1)+52)/5))).*(1-D2_kCurrentMSN_m(:,k-1))-(0.5*exp(-(D2_V(:,k-1)+57)/40)).*D2_kCurrentMSN_m(:,k-1);
  D2_mCurrentMSN_m1=(D2_mCurrentMSN_Qs*1e-4*(D2_V(:,k-1)-(-30))./(1-exp(-(D2_V(:,k-1)-(-30))/9))).*(1-D2_mCurrentMSN_m(:,k-1)) - (-D2_mCurrentMSN_Qs*1e-4*(D2_V(:,k-1)-(-30))./(1-exp((D2_V(:,k-1)-(-30))/9))).*D2_mCurrentMSN_m(:,k-1);
  soma_D2_soma_MSN_iSYN_s1=-soma_D2_soma_MSN_iSYN_s(:,k-1)./(13) + ((1-soma_D2_soma_MSN_iSYN_s(:,k-1))/(0.25)).*(1+tanh(soma_v(:,k-1)/10));
  D2_D2_gabaRecInputMSN_s1=-D2_D2_gabaRecInputMSN_s(:,k-1)./(13) + 2*(1+tanh(D2_V(:,k-1)/4)).*(1-D2_D2_gabaRecInputMSN_s(:,k-1));
  t=t+0.5*dt;
  soma_v2=((-((8).*((soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a1).^3).*(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b1).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n1).^(2)).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h1).*((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)-(-24))./11.5))).^3).*((soma_v(:,k-1)+.5*dt*soma_v1)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+.5*dt*soma_v1)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1)).*((soma_v(:,k-1)+.5*dt*soma_v1)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1)))'-((soma_v(:,k-1)+.5*dt*soma_v1)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v1),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a1))./2;
  soma_soma_golomb_K_b2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b1))./(120);
  soma_soma_golomb_Kdr_n2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n1))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+.5*dt*soma_v1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)-1.3)./18.7))));
  soma_soma_golomb_Na_h2=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h1))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v1)+60)./-12)));
  soma_soma_soma_soma_iSYN_s2=-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  dend_v2=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a1).^3).*(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b1).*((dend_v(:,k-1)+.5*dt*dend_v1)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n1).^(2)).*((dend_v(:,k-1)+.5*dt*dend_v1)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h1).*((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)-(-24))./11.5))).^3).*((dend_v(:,k-1)+.5*dt*dend_v1)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+.5*dt*dend_v1)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v1) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v1) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+.5*dt*soma_v1)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v1),1)))'-((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1)))'-((dend_v(:,k-1)+.5*dt*dend_v1)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v1),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a1))./2;
  dend_dend_golomb_K_b2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b1))./(120);
  dend_dend_golomb_Kdr_n2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n1))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+.5*dt*dend_v1)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)-1.3)./18.7))));
  dend_dend_golomb_Na_h2=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h1))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v1)+60)./-12)));
  D1_V2=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1).^3.*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1).*((D1_V(:,k-1)+.5*dt*D1_V1)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1).^4.*((D1_V(:,k-1)+.5*dt*D1_V1)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-100))))+((-((0.1)*((D1_V(:,k-1)+.5*dt*D1_V1)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1)).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1)).*((D1_V(:,k-1)+.5*dt*D1_V1)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m2=(0.32*((D1_V(:,k-1)+.5*dt*D1_V1)+54)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1))-(0.28*((D1_V(:,k-1)+.5*dt*D1_V1)+27)./(exp(((D1_V(:,k-1)+.5*dt*D1_V1)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m1);
  D1_naCurrentMSN_h2=(0.128*exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1))-(4./(1+exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h1);
  D1_kCurrentMSN_m2=(0.032*((D1_V(:,k-1)+.5*dt*D1_V1)+52)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1))-(0.5*exp(-((D1_V(:,k-1)+.5*dt*D1_V1)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m1);
  D1_mCurrentMSN_m2=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))./(1-exp(((D1_V(:,k-1)+.5*dt*D1_V1)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m1);
  soma_D1_soma_MSN_iSYN_s2=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  D1_D1_gabaRecInputMSN_s2=-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1)./(13) + 2*(1+tanh((D1_V(:,k-1)+.5*dt*D1_V1)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s1));
  D2_V2=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1).^3.*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1).*((D2_V(:,k-1)+.5*dt*D2_V1)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1).^4.*((D2_V(:,k-1)+.5*dt*D2_V1)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-100))))+((-((0.1)*((D2_V(:,k-1)+.5*dt*D2_V1)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1)).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1)).*((D2_V(:,k-1)+.5*dt*D2_V1)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m2=(0.32*((D2_V(:,k-1)+.5*dt*D2_V1)+54)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1))-(0.28*((D2_V(:,k-1)+.5*dt*D2_V1)+27)./(exp(((D2_V(:,k-1)+.5*dt*D2_V1)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m1);
  D2_naCurrentMSN_h2=(0.128*exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1))-(4./(1+exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h1);
  D2_kCurrentMSN_m2=(0.032*((D2_V(:,k-1)+.5*dt*D2_V1)+52)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1))-(0.5*exp(-((D2_V(:,k-1)+.5*dt*D2_V1)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m1);
  D2_mCurrentMSN_m2=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))./(1-exp(((D2_V(:,k-1)+.5*dt*D2_V1)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m1);
  soma_D2_soma_MSN_iSYN_s2=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s1))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v1)/10));
  D2_D2_gabaRecInputMSN_s2=-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1)./(13) + 2*(1+tanh((D2_V(:,k-1)+.5*dt*D2_V1)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s1));
  soma_v3=((-((8).*((soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a2).^3).*(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b2).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n2).^(2)).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h2).*((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)-(-24))./11.5))).^3).*((soma_v(:,k-1)+.5*dt*soma_v2)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+.5*dt*soma_v2)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2)).*((soma_v(:,k-1)+.5*dt*soma_v2)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1)))'-((soma_v(:,k-1)+.5*dt*soma_v2)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v2),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+.5*dt*soma_soma_golomb_K_a2))./2;
  soma_soma_golomb_K_b3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+.5*dt*soma_soma_golomb_K_b2))./(120);
  soma_soma_golomb_Kdr_n3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+.5*dt*soma_soma_golomb_Kdr_n2))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+.5*dt*soma_v2)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)-1.3)./18.7))));
  soma_soma_golomb_Na_h3=((1./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+.5*dt*soma_soma_golomb_Na_h2))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+.5*dt*soma_v2)+60)./-12)));
  soma_soma_soma_soma_iSYN_s3=-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+.5*dt*soma_soma_soma_soma_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  dend_v3=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a2).^3).*(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b2).*((dend_v(:,k-1)+.5*dt*dend_v2)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n2).^(2)).*((dend_v(:,k-1)+.5*dt*dend_v2)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h2).*((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)-(-24))./11.5))).^3).*((dend_v(:,k-1)+.5*dt*dend_v2)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+.5*dt*dend_v2)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v2) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+.5*dt*dend_v2) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+.5*dt*soma_v2)*ones(1,size((soma_v(:,k-1)+.5*dt*soma_v2),1)))'-((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1)))'-((dend_v(:,k-1)+.5*dt*dend_v2)*ones(1,size((dend_v(:,k-1)+.5*dt*dend_v2),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+.5*dt*dend_dend_golomb_K_a2))./2;
  dend_dend_golomb_K_b3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+.5*dt*dend_dend_golomb_K_b2))./(120);
  dend_dend_golomb_Kdr_n3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+.5*dt*dend_dend_golomb_Kdr_n2))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+.5*dt*dend_v2)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)-1.3)./18.7))));
  dend_dend_golomb_Na_h3=((1./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+.5*dt*dend_dend_golomb_Na_h2))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+.5*dt*dend_v2)+60)./-12)));
  D1_V3=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2).^3.*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2).*((D1_V(:,k-1)+.5*dt*D1_V2)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2).^4.*((D1_V(:,k-1)+.5*dt*D1_V2)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-100))))+((-((0.1)*((D1_V(:,k-1)+.5*dt*D1_V2)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2)).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2)).*((D1_V(:,k-1)+.5*dt*D1_V2)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m3=(0.32*((D1_V(:,k-1)+.5*dt*D1_V2)+54)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2))-(0.28*((D1_V(:,k-1)+.5*dt*D1_V2)+27)./(exp(((D1_V(:,k-1)+.5*dt*D1_V2)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+.5*dt*D1_naCurrentMSN_m2);
  D1_naCurrentMSN_h3=(0.128*exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2))-(4./(1+exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+.5*dt*D1_naCurrentMSN_h2);
  D1_kCurrentMSN_m3=(0.032*((D1_V(:,k-1)+.5*dt*D1_V2)+52)./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2))-(0.5*exp(-((D1_V(:,k-1)+.5*dt*D1_V2)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+.5*dt*D1_kCurrentMSN_m2);
  D1_mCurrentMSN_m3=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))./(1-exp(-((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))./(1-exp(((D1_V(:,k-1)+.5*dt*D1_V2)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+.5*dt*D1_mCurrentMSN_m2);
  soma_D1_soma_MSN_iSYN_s3=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D1_soma_MSN_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  D1_D1_gabaRecInputMSN_s3=-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2)./(13) + 2*(1+tanh((D1_V(:,k-1)+.5*dt*D1_V2)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+.5*dt*D1_D1_gabaRecInputMSN_s2));
  D2_V3=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2).^3.*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2).*((D2_V(:,k-1)+.5*dt*D2_V2)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2).^4.*((D2_V(:,k-1)+.5*dt*D2_V2)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-100))))+((-((0.1)*((D2_V(:,k-1)+.5*dt*D2_V2)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2)).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2)).*((D2_V(:,k-1)+.5*dt*D2_V2)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m3=(0.32*((D2_V(:,k-1)+.5*dt*D2_V2)+54)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2))-(0.28*((D2_V(:,k-1)+.5*dt*D2_V2)+27)./(exp(((D2_V(:,k-1)+.5*dt*D2_V2)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+.5*dt*D2_naCurrentMSN_m2);
  D2_naCurrentMSN_h3=(0.128*exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2))-(4./(1+exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+.5*dt*D2_naCurrentMSN_h2);
  D2_kCurrentMSN_m3=(0.032*((D2_V(:,k-1)+.5*dt*D2_V2)+52)./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2))-(0.5*exp(-((D2_V(:,k-1)+.5*dt*D2_V2)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+.5*dt*D2_kCurrentMSN_m2);
  D2_mCurrentMSN_m3=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))./(1-exp(-((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))./(1-exp(((D2_V(:,k-1)+.5*dt*D2_V2)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+.5*dt*D2_mCurrentMSN_m2);
  soma_D2_soma_MSN_iSYN_s3=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+.5*dt*soma_D2_soma_MSN_iSYN_s2))/(0.25)).*(1+tanh((soma_v(:,k-1)+.5*dt*soma_v2)/10));
  D2_D2_gabaRecInputMSN_s3=-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2)./(13) + 2*(1+tanh((D2_V(:,k-1)+.5*dt*D2_V2)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+.5*dt*D2_D2_gabaRecInputMSN_s2));
  t=t+0.5*dt;
  soma_v4=((-((8).*((soma_soma_golomb_K_a(:,k-1)+dt*soma_soma_golomb_K_a3).^3).*(soma_soma_golomb_K_b(:,k-1)+dt*soma_soma_golomb_K_b3).*((soma_v(:,k-1)+dt*soma_v3)-(-90))))+((-((225).*((soma_soma_golomb_Kdr_n(:,k-1)+dt*soma_soma_golomb_Kdr_n3).^(2)).*((soma_v(:,k-1)+dt*soma_v3)-(-90))))+((-((112).*(soma_soma_golomb_Na_h(:,k-1)+dt*soma_soma_golomb_Na_h3).*((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)-(-24))./11.5))).^3).*((soma_v(:,k-1)+dt*soma_v3)-(50))))+((((0)))+((-((0.03)*((soma_v(:,k-1)+dt*soma_v3)-(-54.4))))+((-((soma_soma_soma_soma_iSYN_gsyn2.*(soma_soma_soma_soma_iSYN_mask*(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3)).*((soma_v(:,k-1)+dt*soma_v3)-(-80)))))+((((0.15).*sum(((((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1)))'-((soma_v(:,k-1)+dt*soma_v3)*ones(1,size((soma_v(:,k-1)+dt*soma_v3),1))))).*dend_soma_dend_soma_iCOM_compcon,2)))+0)))))));
  soma_soma_golomb_K_a4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+50)./20)))-(soma_soma_golomb_K_a(:,k-1)+dt*soma_soma_golomb_K_a3))./2;
  soma_soma_golomb_K_b4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+70)./-6)))-(soma_soma_golomb_K_b(:,k-1)+dt*soma_soma_golomb_K_b3))./(120);
  soma_soma_golomb_Kdr_n4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+12.4)./6.8)))-(soma_soma_golomb_Kdr_n(:,k-1)+dt*soma_soma_golomb_Kdr_n3))./((1)*(0.087+11.4./(1+exp(((soma_v(:,k-1)+dt*soma_v3)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)-1.3)./18.7))));
  soma_soma_golomb_Na_h4=((1./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+58.3)./-6.7)))-(soma_soma_golomb_Na_h(:,k-1)+dt*soma_soma_golomb_Na_h3))./(0.5 + 14./(1+exp(-((soma_v(:,k-1)+dt*soma_v3)+60)./-12)));
  soma_soma_soma_soma_iSYN_s4=-(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3)./(13) + ((1-(soma_soma_soma_soma_iSYN_s(:,k-1)+dt*soma_soma_soma_soma_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  dend_v4=((-(dend_dend_golomb_K_gd_dend.*((dend_dend_golomb_K_a(:,k-1)+dt*dend_dend_golomb_K_a3).^3).*(dend_dend_golomb_K_b(:,k-1)+dt*dend_dend_golomb_K_b3).*((dend_v(:,k-1)+dt*dend_v3)-(-90))))+((-(dend_dend_golomb_Kdr_gkdr_dend.*((dend_dend_golomb_Kdr_n(:,k-1)+dt*dend_dend_golomb_Kdr_n3).^(2)).*((dend_v(:,k-1)+dt*dend_v3)-(-90))))+((-(dend_dend_golomb_Na_gna_dend.*(dend_dend_golomb_Na_h(:,k-1)+dt*dend_dend_golomb_Na_h3).*((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)-(-24))./11.5))).^3).*((dend_v(:,k-1)+dt*dend_v3)-(50))))+(((dend_dend_input_tonic2))+((-((0.03)*((dend_v(:,k-1)+dt*dend_v3)-(-54.4))))+((-((((1).*dend_dend_iMultiPoissonExp_Ge(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+dt*dend_v3) - (0))) + (((1).*dend_dend_iMultiPoissonExp_Gi(:, max(1,round(t/(0.01))))).*((dend_v(:,k-1)+dt*dend_v3) - (-85)))))+((((0.15).*sum(((((soma_v(:,k-1)+dt*soma_v3)*ones(1,size((soma_v(:,k-1)+dt*soma_v3),1)))'-((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1))))).*soma_dend_soma_dend_iCOM_compcon,2)))+(((dend_dend_dend_dend_iGAP_g_GAP2.*sum(((((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1)))'-((dend_v(:,k-1)+dt*dend_v3)*ones(1,size((dend_v(:,k-1)+dt*dend_v3),1))))).*dend_dend_dend_dend_iGAP_mask,2)))+0))))))));
  dend_dend_golomb_K_a4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+50)./20)))-(dend_dend_golomb_K_a(:,k-1)+dt*dend_dend_golomb_K_a3))./2;
  dend_dend_golomb_K_b4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+70)./-6)))-(dend_dend_golomb_K_b(:,k-1)+dt*dend_dend_golomb_K_b3))./(120);
  dend_dend_golomb_Kdr_n4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+12.4)./6.8)))-(dend_dend_golomb_Kdr_n(:,k-1)+dt*dend_dend_golomb_Kdr_n3))./((1)*(0.087+11.4./(1+exp(((dend_v(:,k-1)+dt*dend_v3)+14.6)./8.6))) .* (0.087+11.4./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)-1.3)./18.7))));
  dend_dend_golomb_Na_h4=((1./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+58.3)./-6.7)))-(dend_dend_golomb_Na_h(:,k-1)+dt*dend_dend_golomb_Na_h3))./(0.5 + 14./(1+exp(-((dend_v(:,k-1)+dt*dend_v3)+60)./-12)));
  D1_V4=(((-((100)*(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3).^3.*(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3).*((D1_V(:,k-1)+dt*D1_V3)-(50))))+((-((80)*(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3).^4.*((D1_V(:,k-1)+dt*D1_V3)-(-100))))+((-((1.3)*(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3).*((D1_V(:,k-1)+dt*D1_V3)-(-100))))+((-((0.1)*((D1_V(:,k-1)+dt*D1_V3)-(-67))))+((((1.19) + (0)*sin(2*pi*D1_injectedCurrentD1_freq*t/1000) + 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D1_soma_MSN_iSYN_gsyn2.*(soma_D1_soma_MSN_iSYN_mask*(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3)).*((D1_V(:,k-1)+dt*D1_V3)-(-80)))))+((-((0.0010101).*(D1_D1_gabaRecInputMSN_netcon*(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3)).*((D1_V(:,k-1)+dt*D1_V3)-(-80))))+0)))))))))./(1);
  D1_naCurrentMSN_m4=(0.32*((D1_V(:,k-1)+dt*D1_V3)+54)./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)+54)/4))).*(1-(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3))-(0.28*((D1_V(:,k-1)+dt*D1_V3)+27)./(exp(((D1_V(:,k-1)+dt*D1_V3)+27)/5)-1)).*(D1_naCurrentMSN_m(:,k-1)+dt*D1_naCurrentMSN_m3);
  D1_naCurrentMSN_h4=(0.128*exp(-((D1_V(:,k-1)+dt*D1_V3)+50)/18)).*(1-(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3))-(4./(1+exp(-((D1_V(:,k-1)+dt*D1_V3)+27)/5))).*(D1_naCurrentMSN_h(:,k-1)+dt*D1_naCurrentMSN_h3);
  D1_kCurrentMSN_m4=(0.032*((D1_V(:,k-1)+dt*D1_V3)+52)./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)+52)/5))).*(1-(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3))-(0.5*exp(-((D1_V(:,k-1)+dt*D1_V3)+57)/40)).*(D1_kCurrentMSN_m(:,k-1)+dt*D1_kCurrentMSN_m3);
  D1_mCurrentMSN_m4=(D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+dt*D1_V3)-(-30))./(1-exp(-((D1_V(:,k-1)+dt*D1_V3)-(-30))/9))).*(1-(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3)) - (-D1_mCurrentMSN_Qs*1e-4*((D1_V(:,k-1)+dt*D1_V3)-(-30))./(1-exp(((D1_V(:,k-1)+dt*D1_V3)-(-30))/9))).*(D1_mCurrentMSN_m(:,k-1)+dt*D1_mCurrentMSN_m3);
  soma_D1_soma_MSN_iSYN_s4=-(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3)./(13) + ((1-(soma_D1_soma_MSN_iSYN_s(:,k-1)+dt*soma_D1_soma_MSN_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  D1_D1_gabaRecInputMSN_s4=-(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3)./(13) + 2*(1+tanh((D1_V(:,k-1)+dt*D1_V3)/4)).*(1-(D1_D1_gabaRecInputMSN_s(:,k-1)+dt*D1_D1_gabaRecInputMSN_s3));
  D2_V4=(((-((100)*(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3).^3.*(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3).*((D2_V(:,k-1)+dt*D2_V3)-(50))))+((-((80)*(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3).^4.*((D2_V(:,k-1)+dt*D2_V3)-(-100))))+((-((1.3)*(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3).*((D2_V(:,k-1)+dt*D2_V3)-(-100))))+((-((0.1)*((D2_V(:,k-1)+dt*D2_V3)-(-67))))+((((1.19) + (0)*sin(2*pi*D2_injectedCurrentD2_freq*t/1000) - 0.1*(0)))+((((4).*randn((100),1).*sqrt((0.01))))+((-((soma_D2_soma_MSN_iSYN_gsyn2.*(soma_D2_soma_MSN_iSYN_mask*(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3)).*((D2_V(:,k-1)+dt*D2_V3)-(-80)))))+((-((0.0010101).*(D2_D2_gabaRecInputMSN_netcon*(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3)).*((D2_V(:,k-1)+dt*D2_V3)-(-80))))+0)))))))))./(1);
  D2_naCurrentMSN_m4=(0.32*((D2_V(:,k-1)+dt*D2_V3)+54)./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)+54)/4))).*(1-(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3))-(0.28*((D2_V(:,k-1)+dt*D2_V3)+27)./(exp(((D2_V(:,k-1)+dt*D2_V3)+27)/5)-1)).*(D2_naCurrentMSN_m(:,k-1)+dt*D2_naCurrentMSN_m3);
  D2_naCurrentMSN_h4=(0.128*exp(-((D2_V(:,k-1)+dt*D2_V3)+50)/18)).*(1-(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3))-(4./(1+exp(-((D2_V(:,k-1)+dt*D2_V3)+27)/5))).*(D2_naCurrentMSN_h(:,k-1)+dt*D2_naCurrentMSN_h3);
  D2_kCurrentMSN_m4=(0.032*((D2_V(:,k-1)+dt*D2_V3)+52)./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)+52)/5))).*(1-(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3))-(0.5*exp(-((D2_V(:,k-1)+dt*D2_V3)+57)/40)).*(D2_kCurrentMSN_m(:,k-1)+dt*D2_kCurrentMSN_m3);
  D2_mCurrentMSN_m4=(D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+dt*D2_V3)-(-30))./(1-exp(-((D2_V(:,k-1)+dt*D2_V3)-(-30))/9))).*(1-(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3)) - (-D2_mCurrentMSN_Qs*1e-4*((D2_V(:,k-1)+dt*D2_V3)-(-30))./(1-exp(((D2_V(:,k-1)+dt*D2_V3)-(-30))/9))).*(D2_mCurrentMSN_m(:,k-1)+dt*D2_mCurrentMSN_m3);
  soma_D2_soma_MSN_iSYN_s4=-(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3)./(13) + ((1-(soma_D2_soma_MSN_iSYN_s(:,k-1)+dt*soma_D2_soma_MSN_iSYN_s3))/(0.25)).*(1+tanh((soma_v(:,k-1)+dt*soma_v3)/10));
  D2_D2_gabaRecInputMSN_s4=-(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3)./(13) + 2*(1+tanh((D2_V(:,k-1)+dt*D2_V3)/4)).*(1-(D2_D2_gabaRecInputMSN_s(:,k-1)+dt*D2_D2_gabaRecInputMSN_s3));
  soma_v(:,k) = soma_v(:,k-1) + (dt/6)*(soma_v1+2*(soma_v2+soma_v3)+soma_v4);
  soma_soma_golomb_K_a(:,k) = soma_soma_golomb_K_a(:,k-1) + (dt/6)*(soma_soma_golomb_K_a1+2*(soma_soma_golomb_K_a2+soma_soma_golomb_K_a3)+soma_soma_golomb_K_a4);
  soma_soma_golomb_K_b(:,k) = soma_soma_golomb_K_b(:,k-1) + (dt/6)*(soma_soma_golomb_K_b1+2*(soma_soma_golomb_K_b2+soma_soma_golomb_K_b3)+soma_soma_golomb_K_b4);
  soma_soma_golomb_Kdr_n(:,k) = soma_soma_golomb_Kdr_n(:,k-1) + (dt/6)*(soma_soma_golomb_Kdr_n1+2*(soma_soma_golomb_Kdr_n2+soma_soma_golomb_Kdr_n3)+soma_soma_golomb_Kdr_n4);
  soma_soma_golomb_Na_h(:,k) = soma_soma_golomb_Na_h(:,k-1) + (dt/6)*(soma_soma_golomb_Na_h1+2*(soma_soma_golomb_Na_h2+soma_soma_golomb_Na_h3)+soma_soma_golomb_Na_h4);
  soma_soma_soma_soma_iSYN_s(:,k) = soma_soma_soma_soma_iSYN_s(:,k-1) + (dt/6)*(soma_soma_soma_soma_iSYN_s1+2*(soma_soma_soma_soma_iSYN_s2+soma_soma_soma_soma_iSYN_s3)+soma_soma_soma_soma_iSYN_s4);
  dend_v(:,k) = dend_v(:,k-1) + (dt/6)*(dend_v1+2*(dend_v2+dend_v3)+dend_v4);
  dend_dend_golomb_K_a(:,k) = dend_dend_golomb_K_a(:,k-1) + (dt/6)*(dend_dend_golomb_K_a1+2*(dend_dend_golomb_K_a2+dend_dend_golomb_K_a3)+dend_dend_golomb_K_a4);
  dend_dend_golomb_K_b(:,k) = dend_dend_golomb_K_b(:,k-1) + (dt/6)*(dend_dend_golomb_K_b1+2*(dend_dend_golomb_K_b2+dend_dend_golomb_K_b3)+dend_dend_golomb_K_b4);
  dend_dend_golomb_Kdr_n(:,k) = dend_dend_golomb_Kdr_n(:,k-1) + (dt/6)*(dend_dend_golomb_Kdr_n1+2*(dend_dend_golomb_Kdr_n2+dend_dend_golomb_Kdr_n3)+dend_dend_golomb_Kdr_n4);
  dend_dend_golomb_Na_h(:,k) = dend_dend_golomb_Na_h(:,k-1) + (dt/6)*(dend_dend_golomb_Na_h1+2*(dend_dend_golomb_Na_h2+dend_dend_golomb_Na_h3)+dend_dend_golomb_Na_h4);
  D1_V(:,k) = D1_V(:,k-1) + (dt/6)*(D1_V1+2*(D1_V2+D1_V3)+D1_V4);
  D1_naCurrentMSN_m(:,k) = D1_naCurrentMSN_m(:,k-1) + (dt/6)*(D1_naCurrentMSN_m1+2*(D1_naCurrentMSN_m2+D1_naCurrentMSN_m3)+D1_naCurrentMSN_m4);
  D1_naCurrentMSN_h(:,k) = D1_naCurrentMSN_h(:,k-1) + (dt/6)*(D1_naCurrentMSN_h1+2*(D1_naCurrentMSN_h2+D1_naCurrentMSN_h3)+D1_naCurrentMSN_h4);
  D1_kCurrentMSN_m(:,k) = D1_kCurrentMSN_m(:,k-1) + (dt/6)*(D1_kCurrentMSN_m1+2*(D1_kCurrentMSN_m2+D1_kCurrentMSN_m3)+D1_kCurrentMSN_m4);
  D1_mCurrentMSN_m(:,k) = D1_mCurrentMSN_m(:,k-1) + (dt/6)*(D1_mCurrentMSN_m1+2*(D1_mCurrentMSN_m2+D1_mCurrentMSN_m3)+D1_mCurrentMSN_m4);
  soma_D1_soma_MSN_iSYN_s(:,k) = soma_D1_soma_MSN_iSYN_s(:,k-1) + (dt/6)*(soma_D1_soma_MSN_iSYN_s1+2*(soma_D1_soma_MSN_iSYN_s2+soma_D1_soma_MSN_iSYN_s3)+soma_D1_soma_MSN_iSYN_s4);
  D1_D1_gabaRecInputMSN_s(:,k) = D1_D1_gabaRecInputMSN_s(:,k-1) + (dt/6)*(D1_D1_gabaRecInputMSN_s1+2*(D1_D1_gabaRecInputMSN_s2+D1_D1_gabaRecInputMSN_s3)+D1_D1_gabaRecInputMSN_s4);
  D2_V(:,k) = D2_V(:,k-1) + (dt/6)*(D2_V1+2*(D2_V2+D2_V3)+D2_V4);
  D2_naCurrentMSN_m(:,k) = D2_naCurrentMSN_m(:,k-1) + (dt/6)*(D2_naCurrentMSN_m1+2*(D2_naCurrentMSN_m2+D2_naCurrentMSN_m3)+D2_naCurrentMSN_m4);
  D2_naCurrentMSN_h(:,k) = D2_naCurrentMSN_h(:,k-1) + (dt/6)*(D2_naCurrentMSN_h1+2*(D2_naCurrentMSN_h2+D2_naCurrentMSN_h3)+D2_naCurrentMSN_h4);
  D2_kCurrentMSN_m(:,k) = D2_kCurrentMSN_m(:,k-1) + (dt/6)*(D2_kCurrentMSN_m1+2*(D2_kCurrentMSN_m2+D2_kCurrentMSN_m3)+D2_kCurrentMSN_m4);
  D2_mCurrentMSN_m(:,k) = D2_mCurrentMSN_m(:,k-1) + (dt/6)*(D2_mCurrentMSN_m1+2*(D2_mCurrentMSN_m2+D2_mCurrentMSN_m3)+D2_mCurrentMSN_m4);
  soma_D2_soma_MSN_iSYN_s(:,k) = soma_D2_soma_MSN_iSYN_s(:,k-1) + (dt/6)*(soma_D2_soma_MSN_iSYN_s1+2*(soma_D2_soma_MSN_iSYN_s2+soma_D2_soma_MSN_iSYN_s3)+soma_D2_soma_MSN_iSYN_s4);
  D2_D2_gabaRecInputMSN_s(:,k) = D2_D2_gabaRecInputMSN_s(:,k-1) + (dt/6)*(D2_D2_gabaRecInputMSN_s1+2*(D2_D2_gabaRecInputMSN_s2+D2_D2_gabaRecInputMSN_s3)+D2_D2_gabaRecInputMSN_s4);
  if any(k == enableLog)
    elapsedTime = toc(tstart);
    elapsedTimeMinutes = floor(elapsedTime/60);
    elapsedTimeSeconds = rem(elapsedTime,60);
    if elapsedTimeMinutes
        fprintf('Processed %g of %g ms (elapsed time: %g m %.3f s)\n',T(k),T(end),elapsedTimeMinutes,elapsedTimeSeconds);
    else
        fprintf('Processed %g of %g ms (elapsed time: %.3f s)\n',T(k),T(end),elapsedTimeSeconds);
    end
  end
end
Y=cat(1,soma_v,soma_soma_golomb_K_a,soma_soma_golomb_K_b,soma_soma_golomb_Kdr_n,soma_soma_golomb_Na_h,soma_soma_soma_soma_iSYN_s,dend_v,dend_dend_golomb_K_a,dend_dend_golomb_K_b,dend_dend_golomb_Kdr_n,dend_dend_golomb_Na_h,D1_V,D1_naCurrentMSN_m,D1_naCurrentMSN_h,D1_kCurrentMSN_m,D1_mCurrentMSN_m,soma_D1_soma_MSN_iSYN_s,D1_D1_gabaRecInputMSN_s,D2_V,D2_naCurrentMSN_m,D2_naCurrentMSN_h,D2_kCurrentMSN_m,D2_mCurrentMSN_m,soma_D2_soma_MSN_iSYN_s,D2_D2_gabaRecInputMSN_s)';
